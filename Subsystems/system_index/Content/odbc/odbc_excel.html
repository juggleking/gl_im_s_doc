<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="system_index.xml" data-mc-path-to-help-system="../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="ODBC|Examples" data-mc-priority="0" data-mc-time-estimate="0" data-mc-id="v55\english\tutorials\extra tools\odbc\ODBC excel.html">
    <!-- saved from url=(0016)http://localhost -->
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>ODBC - Example in MS Excel</title>
        <link href="../Resources/StyleSheets/shared.css" rel="stylesheet" type="text/css" />
        <script src="../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../Resources/Scripts/require.min.js" defer="defer" type="text/javascript">
        </script>
        <script src="../../Resources/Scripts/require.config.js" defer="defer" type="text/javascript">
        </script>
        <script src="../../Resources/Scripts/foundation.min.js" defer="defer" type="text/javascript">
        </script>
        <script src="../../Resources/Scripts/plugins.min.js" defer="defer" type="text/javascript">
        </script>
        <script src="../../Resources/Scripts/MadCapAll.js" defer="defer" type="text/javascript">
        </script>
    </head>
    <body style="color: #000000;">
        <h1>System manual -&gt; ODBC: example in MS Excel</h1>
        <h3>1. Introduction.</h3>
        <p>Before we begin with this tutorial, it is expected that:</p>
        <ul>
            <li class="kadov-p" value="1">There is an installed and working ODBC server - client connection (Intersolv 3.10 32-bit Sequelink) on your system.</li>
            <li class="kadov-p" value="2">You have a working knowledge of Excel or Access.</li>
            <li class="kadov-p" value="3">You have a basic understanding of SQL.</li>
            <li class="kadov-p" value="4">The GLIMS documentation is installed on your system. This is essential because with the help of the documentation it will be possible to select the right tables in the GLIMS databases.</li>
        </ul>
The ODBC link makes it possible to interrogate your GLIMS database in an easy and consistent way. This tutorial will explain how to choose the right GLIMS tables and how to deploy the information hidden within.
<h3>2. EXCEL configuration.</h3><p>Remark.&#160;&#160;If you have already set the file DSN, skip this chapter.&#160;</p><p>First of all, we are going to make the ODBC link from EXCEL to GLIMS. Here we work with EXCEL, but the same is possible with e.g. ACCESS.<br /><br />
The GLIMS application contains three databases: the genro, genrw and the glims database. So if you want to have access to the data contained in these databases, each of these has to be defined. This configuration must be done only once for each database. The next time you start EXCEL, you will see that the connection has been saved.</p><table style="border-collapse: separate;border-collapse: separate;" cellspacing="0" border="1" bordercolor="#00CC66"><tr><td>&#160; In order to know which database you have to access the following rules apply:
<ol><li class="kadov-p" value="1">If the table name contains an underscore " _ " then it will be a table in the genro or genrw database, e.g. sc_user, gp_text,...</li><li class="kadov-p" value="2">If you can change the data of this tables then it is located in the genrw database. If you can't change the data then it is in the genro database.</li><li class="kadov-p" value="3">All other tables can be found in the glims database.</li></ol></td></tr></table><ul><li class="kadov-p" value="1">Open EXCEL. The application starts with a blank worksheet. Select Data in the menu. Select now Get External Data and click on Create New Query<br /><br /><img src="image1.jpg" style="border-width: 1px;border-style: solid;" alt="" width="547" height="414" border="1" /></li><li class="kadov-p" value="2">A new menu will appear: Choose Data Source . Choose New Data Source and click O.K.<br /><br /><img src="image2.jpg" style="border-width: 1px;border-style: solid;" alt="" width="458" height="229" border="1" /></li><li class="kadov-p" value="3">A new menu will appear: Create New Data Source. Fill in the name of the database you want to connect to:<br /><br /><img src="image3.jpg" style="border-width: 1px;border-style: solid;" alt="" width="382" height="293" border="1" /></li><li class="kadov-p" value="4">Now select a driver for the type of database you want to access. Click on Intersolv 3.10 32-bit Sequelink.<br /><br /><img src="image4.jpg" style="border-width: 1px;border-style: solid;" alt="" width="381" height="291" border="1" /></li><li class="kadov-p" value="5">A new menu will appear: SequeLink Data Sources. Select the database you want to connect to. If the ODBC-connection was installed by MIPS then it will be possible to select from the three GLIMS databases: genro, genrw and glims. For our example we will select the glims database.<br /><br /><img src="image5.jpg" style="border-width: 1px;border-style: solid;" alt="" width="279" height="253" border="1" /></li><li class="kadov-p" value="6">A new menu will appear: Logon to SequeLink Service. Fill in your user name and your password of the machine where the database is located.&#160;&#160;You will also have to specify the path and name of the database you want to connect to. Click O.K.<br /><br /><img src="image6.jpg" style="border-width: 1px;border-style: solid;" alt="" width="571" height="366" border="1" /></li><li class="kadov-p" value="7">Now click OK.<br /><br /><img src="image27.jpg" style="border-width: 1px;border-style: solid;" alt="" width="380" height="291" border="1" /></li><li class="kadov-p" value="8">The ODBC link to the database is ready. Click Cancel and exit Excel. Or you can choose the GLIMS database and go to chapter 4 from this tutorial.<br /><br /><img src="image28.jpg" style="border-width: 1px;border-style: solid;" alt="" width="458" height="230" border="1" /></li></ul><h3>3. Choosing the right tables</h3><p>Before we start using the ODBC connection we must focus on what we are going to seek in the GLIMS databases. It is important to understand that each table in GLIMS corresponds with an actual table in the logical structure of the database.<br /><br />
Suppose we want to have a list with all the properties and their corresponding units.</p><ul><li class="kadov-p" value="1">Open the GLIMS documentation and select the table properties<br /><br /><img src="image25.gif" style="border-width: 1px;border-style: solid;" alt="" width="668" height="438" border="1" /></li><li class="kadov-p" value="2">Search the field Unit . You will see a hyperlink to the table Unit. The hyperlink is the blue underscored text. Clicking it, brings you to the documentation of the Unit table. So, now we know that the values of the units will be in the unit table.<br /><br /><img src="image26.gif" style="border-width: 1px;border-style: solid;" alt="" width="685" height="232" border="1" /></li></ul><p>So, if we want to have a list with all the properties and their corresponding units we need to interrogate two tables:</p><ol><li class="kadov-p" value="1">the Property table</li><li class="kadov-p" value="2">the Unit table</li></ol><h3>4. Working with the databases in Excel.</h3><ul><li class="kadov-p" value="1">Open EXCEL. The application starts with a blanck worksheet. Select Data in the menu. Select now Get External Data and click on Create New Query<br /><br /><img src="image1.jpg" style="border-width: 1px;border-style: solid;" alt="" width="547" height="414" border="1" /></li><li class="kadov-p" value="2">A new menu will appear: Choose Data Source . Choose the GLIMS database and click O.K.<br /><br /><img src="image8.jpg" style="border-width: 1px;border-style: solid;" alt="" width="458" height="230" border="1" /></li><li class="kadov-p" value="3">The Query Wizard is started and will guide you through the selection of the right tables.<br /><br /><img src="image9.jpg" style="border-width: 1px;border-style: solid;" alt="" width="496" height="300" border="1" /></li><li class="kadov-p" value="4">Select the property table and click on the little + sign in front of the table name. The table will expand and all columns from the table are visible. Remember that we wanted to make a list with all the properties and their corresponding units. From the GLIMS documentation on&#160;&#160;the table property we learned that the mnemonic is an easy-to-remember identifier string and that it is mandatory. This means that the column will never be empty. So we select the column prop_Mnemonic. Click on the highlighted arrow. This action will put the column prop_Mnemonic in your query.<br /><br /><img src="image10.jpg" style="border-width: 1px;border-style: solid;" alt="" width="497" height="301" border="1" /></li><li class="kadov-p" value="5">Now go to the Unit table and expand the contents. Here we will select the Unit_Name column. Click on Next.<br /><br /><img src="image12.jpg" style="border-width: 1px;border-style: solid;" alt="" width="497" height="300" border="1" /></li><li class="kadov-p" value="6">Now we get a message form the Query wizard. It knows the tables but it does not know how to connect them. We have to do this manual. Click on O.K.<br /><br /><img src="image31.jpg" style="border-width: 1px;border-style: solid;" alt="" width="637" height="149" border="1" /></li><li class="kadov-p" value="7">Microsoft Query gives us a visual representation of the two tables we chose. It is up to us to make a link between the tables. Before we do this we make the tables bigger. Go with the mouse to the header of the Unit table. Click with the left mouse in the header and drag the table to the right. Go with the mouse to the border of the highlighted tables. The cursor will change in a double arrow. Then you can push the left mouse button and drag the border to a desired size.<br /><br /><img src="image32.jpg" style="border-width: 1px;border-style: solid;" alt="" width="768" height="536" border="1" /></li><li class="kadov-p" value="8">The link between the Property table and Unit table is unit. Go to the table Property. Select prop_Unit . Click with the left mouse and drag it to the Unit table. Let the mouse button go once you are over the column unit_Id . A link is made.<br /><br /><img src="image33.jpg" style="border-width: 1px;border-style: solid;" alt="" width="649" height="144" border="1" /></li><li class="kadov-p" value="9">Our link is made. Now we will return the data form Microsoft Query to our Excel worksheet. Push the highlighted button.<br /><br /><img src="image34.jpg" style="border-width: 1px;border-style: solid;" alt="" width="455" height="74" border="1" /></li><li class="kadov-p" value="10">The next window appears. Here you can choose where the data must be sent to. Click OK.<br /><br /><img src="image16.jpg" style="border-width: 1px;border-style: solid;" alt="" width="399" height="179" border="1" /></li><li class="kadov-p" value="11">And here is the result of our hard work:<br /><br /><img src="image35.jpg" style="border-width: 1px;border-style: solid;" alt="" width="264" height="420" border="1" /></li></ul><h3>5. More complex example.</h3><p>The graphical interface of Microsoft Query is limited. It is e.g. not possible to work with outer joins and more than two tables. The solution is to write you own SQL query.<br /><br />
Suppose we want a table with all the properties with their units and alternate units. In Excel we start a new query. Select the two tables and let start Microsoft Query automatically. Click on the SQL button. Then in the SQL window that appears you can write your own SQL query.<br /><br /><img src="image18.jpg" style="border-width: 1px;border-style: solid;" alt="" width="710" height="368" border="1" /></p></body>
</html>