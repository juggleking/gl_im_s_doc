<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-gb" xml:lang="en-gb" data-mc-search-type="Stem" data-mc-help-system-file-name="index.xml" data-mc-path-to-help-system="../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Configuration|Advanced" data-mc-file-tags="Status.CheckedContent,Status.Restyled" data-mc-priority="0" data-mc-time-estimate="0" data-mc-id="v55\english\tutorials\advanced configuration\attachments.htm">
    <!-- saved from url=(0016)http://localhost -->
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>attachments</title>
        <link href="../../Resources/StyleSheets/shared.css" rel="stylesheet" type="text/css" />
        <script src="../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../Resources/Scripts/require.min.js" defer="defer" type="text/javascript">
        </script>
        <script src="../../../Resources/Scripts/require.config.js" defer="defer" type="text/javascript">
        </script>
        <script src="../../../Resources/Scripts/foundation.min.js" defer="defer" type="text/javascript">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js" defer="defer" type="text/javascript">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js" defer="defer" type="text/javascript">
        </script>
    </head>
    <body>
        <h1>Attachments</h1>
        <p>Contents: <a href="#Introduction">Introduction</a> - <a href="#Attachin">Attaching a file to a record</a> - <a href="#Opening/">Opening/saving/deleting an attachment</a> - <a href="#Appending%20an%20attachment%20file">Attachment categories</a> - <a href="#Attachme">Attachment folder</a> - <a href="#MISPL">MISPL</a>  - <a href="#Attachme2">Attachment export</a></p>
        <h2><a name="Introduction"></a>Introduction</h2>
        <p>GLIMS allows to attach files to any given table record. &#160;This functionality requires a separate <a href="../../application_management/licenses/licenses.htm">license 
 key</a>.</p>
        <h2><a name="Attachin"></a>Attaching a file to a record</h2>
        <p>The attachments can be appended via the attachment editor and browser, 
 both accessible via the <a href="../../user_interface/user_interface_ribbons_contextual_tools.htm">contextual 
 ribbon tab "Tools"</a>.</p>
        <p><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="attachments_ribbon.png"><img class="MCPopupThumbnail img imgLargeImage" data-mc-width="844" data-mc-height="531" src="attachments_ribbon_thumb_0_120.png" tabindex="" /></a>
        </p>
        <p class="fieldlabel">In the attachment editor
        </p>
        <ul>
            <li value="1">Search a file by double-clicking in the <span class="ui_element">File 
	 field</span>.
            </li>
            <li value="2">Drag and drop a single file from another 
	 application into the <span class="ui_element">File</span> 
	 field.
            </li>
            <li value="3">Type a full path file name in the <span class="ui_element">File</span> 
	 field</li>
        </ul>
        <p class="fieldlabel">In the attachment browser
        </p>
        <ul>
            <li value="1">Drag and drop one or more files from another 
	 application into the browser.
            </li>
        </ul>
        <div class="text_box_notes">
            <p><span style="color: #616E14; font-weight: bold;">Note</span>
            </p>
            <p>The <a href="https://en.wikipedia.org/wiki/User_Account_Control">User account control</a> security mechanism may prevent you from using drag and drop. One way to avoid this issue is to run all your applications with the same type of rights: for instance, if you are running Windows with administrator rights, you should use GLIMS with administrator rights as well.</p>
        </div>
        <h2><a name="Opening/"></a>Opening/saving/deleting an attachment</h2>
        <p class="fieldlabel">Open</p>
        <div class="indented">
            <p>Double-click an attachment in the attachment browser or use the contextual function <span class="ui_element">Open</span>.</p>
        </div>
        <p class="fieldlabel">Save</p>
        <div class="indented">
            <p>Select an attachment in the attachment browser and the contextual function  <span class="ui_element">Save as</span>.</p>
        </div>
        <p class="fieldlabel">Delete</p>
        <div class="indented">
            <p>Select an attachment in the attachment browser and use the <span class="ui_element">Delete</span> key.</p>
            <div class="text_box_notes">
                <p><span style="color: #616E14; font-weight: bold;">Note</span>
                </p>
                <p>If you delete an attachment database record, the associated physical 
 attachment file is deleted too. If the file cannot be deleted, the database 
 record cannot be deleted either.</p>
            </div>
        </div>
        <h2><a name="Appending an attachment file"></a>Attachment categories</h2>
        <p>GLIMS allows storing attachments in different categories. The attachment categories can be defined via <span class="ui_element">Start -&gt; System management -&gt; Site scheme -&gt; Attachment categories</span>.</p>
        <p><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="attachment_categories.png"><img class="MCPopupThumbnail img imgLargeImage" data-mc-width="675" data-mc-height="625" src="attachment_categories_thumb_0_120.png" tabindex="" /></a>
        </p>
        <p>For each attachment, the category can be specified manually but will often be specified automatically 
 by another GLIMS module such as <a href="../../routine/orders/orders_documents_twain_scanning.htm">Twain 
 document scanning</a>. The category is also shown in the attachment browser.</p>
        <p><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="attachment_browser_category.png"><img class="MCPopupThumbnail img imgLargeImage" data-mc-width="717" data-mc-height="614" src="attachment_browser_category_thumb_0_120.png" tabindex="" /></a>
        </p>
        <h2><a name="Attachme"></a>Attachment folder</h2>
        <p class="fieldlabel">Default root folder for attachments</p>
        <div class="indented">
            <p>By default, the root folder for attachments is <span class="ui_element">subfolder &lt;Table Name&gt; of 
 the attachment root folder</span>, which itself is determined by the environment 
 variable <span class="ui_element">GLIMSAttachmentRootFolde</span>r. </p>
            <div class="text_box_notes">
                <p><span style="color: #616E14; font-weight: bold;">Note</span>
                </p>
                <p>You should define the attachment root 
 folder environment variable with backslashes on Windows and with forward 
 slashes on TTY.</p>
            </div>
        </div>
        <p class="fieldlabel">Custom root folder for attachments</p>
        <div class="indented">
            <p style="text-align: left;">The default attachment folder can be overridden with a string-valued 
 site function named <span class="ui_element">AttachmentFolder</span>, scoped to the table. 
 </p>
            <p style="text-align: left;"><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="attachments_sitefunction.gif" data-mc-popup-alt=""><img class="MCPopupThumbnail img imgLargeImage" data-mc-width="544" data-mc-height="481" src="attachments_sitefunction_thumb_0_120.png" alt="" tabindex="" /></a>
            </p>
        </div>
        <p class="fieldlabel">Sub folder for each table record</p>
        <div class="indented">
            <p style="text-align: left;">Inside the root folder for attachments, attachments are stored in a record-specific 
 subfolder, as <span class="ui_element">&lt;Record Id&gt;\&lt;File name&gt;</span>.</p>
            <p style="text-align: left;"><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="attachments_explorer.png" data-mc-popup-alt=""><img class="MCPopupThumbnail img imgLargeImage" data-mc-width="600" data-mc-height="470" src="attachments_explorer_thumb_0_120.png" alt="" tabindex="" /></a>
            </p>
            <div class="text_box_notes">
                <p><span style="color: #616E14; font-weight: bold;">Note</span>
                </p>
                <p>The attachment folder (operating system folder) 
	 must exist and be writable. The record id subfolder is automatically created.</p>
            </div>
        </div>
        <p><span><a name="License key"></a></span>
        </p>
        <h2><a name="MISPL"></a>MISPL</h2>
        <p>The <a href="../../db/reference_guide/gsit.htm#M_GetAttachments">gp_Site</a>-based MISPL function <span class="ui_element">GetAttachments</span> returns a comma-separated list of path/file names for each attachment.</p>
        <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a style="font-weight: bold; color: #003366" href="javascript:void(0)" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage" aria-expanded="false"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="13" width="16" alt="Closed" data-mc-alt2="Open" />Examples</a></span>
            <div class="MCDropDownBody dropDownBody">
                <div class="text_box_examples">
                    <p><span style="color: #003366; font-weight: bold;">Example</span>
                    </p>
                    <p>
                        <img src="MATE_ATCH-00015.png" />
                    </p>
                </div>
            </div>
        </div>
        <h2><a name="Attachme2"></a>Attachment export</h2>
        <p class="fieldlabel">Report builder</p>
        <div class="indented">
            <p>For result reports generated with Report builder, the exported XML contains additional elements with information about any order attachments. The "Order" element contains an "Attachments" element which in turn has a "Attachment" element for each order attachment.</p>
            <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a style="font-weight: bold; color: #003366" href="javascript:void(0)" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage" aria-expanded="false"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="13" width="16" alt="Closed" data-mc-alt2="Open" />Examples</a></span>
                <div class="MCDropDownBody dropDownBody">
                    <div class="text_box_examples">
                        <p><span style="color: #003366; font-weight: bold;">Example</span>
                        </p>
                        <p>
                            <img src="report_builder_xml_attachments_559x330.png" style="width: 559;height: 330;" />
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <p class="fieldlabel">Electronic reports</p>
        <div class="indented">
            <p>Electronic reports can also include attachment information. </p>
            <ol>
                <li value="1">
                    <p>In the <span class="ui_element">Report generation</span> screen, click the <span class="ui_element">Report items</span> button.</p>
                    <p><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="attachments_elec_reports_items.png"><img class="MCPopupThumbnail img imgLargeImage" data-mc-width="568" data-mc-height="524" src="attachments_elec_reports_items_thumb_0_120.png" tabindex="" /></a>
                    </p>
                </li>
                <li value="2">
                    <p>In the <span class="ui_element">Items to export</span> screen, you can select the <span class="ui_element">Attachment categories</span> for which attachment info should be exported. The attachments linked to reported <span class="ui_element">Order</span> and its patient (<span class="ui_element">Person</span>) will be exported.</p>
                    <p><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="attachments_elec_reports_items_selection.png"><img class="MCPopupThumbnail img imgLargeImage" data-mc-width="583" data-mc-height="873" src="attachments_elec_reports_items_selection_thumb_0_120.png" tabindex="" /></a>
                    </p>
                </li>
            </ol>
        </div>
    </body>
</html>