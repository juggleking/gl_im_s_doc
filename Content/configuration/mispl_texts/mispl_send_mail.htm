<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-gb" xml:lang="en-gb" data-mc-search-type="Stem" data-mc-help-system-file-name="index.xml" data-mc-path-to-help-system="../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Configuration|Advanced|MISPL and texts|MISPL" data-mc-file-tags="Status.CheckedContent,Status.Restyled" data-mc-priority="0" data-mc-time-estimate="0" data-mc-id="v55\english\tutorials\extra tools\mailing\mailing.htm">
    <!-- saved from url=(0016)http://localhost -->
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>Sending mail from within MISPL&#160;&#160;&#160;</title>
        <link href="../../Resources/StyleSheets/shared.css" rel="stylesheet" type="text/css" />
        <script src="../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../Resources/Scripts/require.min.js" defer="defer" type="text/javascript">
        </script>
        <script src="../../../Resources/Scripts/require.config.js" defer="defer" type="text/javascript">
        </script>
        <script src="../../../Resources/Scripts/foundation.min.js" defer="defer" type="text/javascript">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js" defer="defer" type="text/javascript">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js" defer="defer" type="text/javascript">
        </script>
    </head>
    <body>
        <h1>Sending mail from within MISPL&#160;&#160;&#160;</h1>
        <h2>Introduction</h2>
        <p><a name="kanchor89"></a>It is possible to send mails from within MISPL. These mails will be either internal database mail (from user to user) or external mail (mail sent via the Internet). &#160;&#160;</p>
        <p class="fieldlabel">Important fields</p>
        <ul>
            <li class="kadov-p" value="1"><span class="ui_element">E-mail address</span> of the <span class="ui_element">Site</span> (<span class="ui_element">Start -&gt; System management -&gt; Customize -&gt; MATE</span>)</li>
            <li class="kadov-p" value="2"><span class="ui_element">E-mail address</span> of a <span class="ui_element">User</span> (<span class="ui_element">Start -&gt; System management -&gt; Security -&gt; Users</span>)</li>
            <li class="kadov-p" value="3"><span class="ui_element">Mail method</span> of a <span class="ui_element">User</span>: a user can specify how he wants to receive his mail. Possible values are: <span class="ui_element">Internal, External, Both</span>.</li>
        </ul>
        <p class="fieldlabel">Important functions</p>
        <ul>
            <li class="kadov-p" value="1"><span class="ui_element">Correspondent.SendMail</span>(From, Subject, Content, Priority)</li>
            <li class="kadov-p" value="2"><span class="ui_element">sc_User.SendMail</span>(Subject, Content, Priority)</li>
            <li class="kadov-p" value="3"><span class="ui_element">sc_Role.SendMail</span>(Subject, Content, Priority)</li>
            <li class="kadov-p" value="4">Without a base table: <span class="ui_element">SendMail</span>(From, To, Subject, Content, Priority)</li>
        </ul>
        <h2><a name="Correspondent.SendMail" id="Correspondent.SendMail"></a>Correspondent.SendMail</h2>
        <p><a name="kanchor90"></a>This mail will always be Internet mail, it will be sent to the email address of the correspondent.</p>
        <table style="border-collapse: separate;border-collapse: separate;" cellspacing="0" width="90%" border="1">
            <tr>
                <td style="width: 100%;padding-left: 3px;padding-top: 3px;padding-right: 3px;padding-bottom: 3px;"><span class="Type">Logical</span>&#160;<b>&#160;SendMail</b> (<span class="Type">String</span>&#160;<span class="Parameter">From</span>, <span class="Type">String</span>&#160;<span class="Parameter">Subject</span>, <span class="Type">String</span>&#160;<span class="Parameter">Content</span>, <span class="Type">MailPriority</span>&#160;<span class="Parameter">Priority</span>)</td>
            </tr>
        </table>
        <p>This MISPL function returns 'True' if the email has been sent successfully.</p>
        <p class="fieldlabel">From</p>
        <div class="indented">
            <p>Possible options</p>
            <ul>
                <li class="kadov-p" value="1"><span class="ui_element">USER</span> : the email address of the user currently logged in</li>
                <li class="kadov-p" value="2"><span class="ui_element">RESPONSIBLE</span> : the email address of the responsible for the employee/user currently logged in</li>
                <li class="kadov-p" value="3"><span class="ui_element">SITE</span> : the email address of the site</li>
                <li class="kadov-p" value="4">a valid e-mail address</li>
            </ul>
        </div>
        <p class="fieldlabel">Subject</p>
        <div class="indented">
            <p>A string with the subject of the mail.</p>
        </div>
        <p class="fieldlabel">Content</p>
        <div class="indented">
            <p>A string or a symbolic text reference : {&lt;text module}. </p>
            <div class="text_box_notes">
                <p><span style="color: #616E14; font-weight: bold;">Note</span>
                </p>
                <p>If you want to send a HTML mail (Internet mail only) the string should start with &lt;HTML&gt; and end with &lt;/HTML&gt;</p>
            </div>
        </div>
        <p class="fieldlabel">Priority</p>
        <div class="indented">
            <p>Indicates the importance of the mail. Can be specified with a number from 1 to 3 or by using the enumerated <span class="ui_element">MailPriority</span>.
</p>
            <ul>
                <li class="kadov-p" value="1">Low: MailPriority["Low"] or 1</li>
                <li class="kadov-p" value="2">Normal: MailPriority["Normal"] or 2</li>
                <li class="kadov-p" value="3">High: MailPriority["High"] or 3</li>
            </ul>
        </div>
        <h2><a name="User.SendMail" id="User.SendMail"></a>sc_User.SendMail</h2>
        <p>This mail will be Internet mail if the target user has <span class="ui_element">External</span> as <span class="ui_element">Mail method</span> or database mail if the user has <span class="ui_element">Internal</span> as <span class="ui_element">Mail method</span> (or both if the user has 'both' as mail method). There is no <span class="ui_element">From</span> argument, the user currently logged in will be taken as <span class="ui_element">From</span>.</p>
        <table style="border-collapse: separate;border-collapse: separate;" cellspacing="0" width="90%" border="1">
            <tr>
                <td style="width: 100%;padding-left: 3px;padding-top: 3px;padding-right: 3px;padding-bottom: 3px;"><span class="Type">Logical</span>&#160;<b>&#160;SendMail</b> (<span class="Type">String</span>&#160;<span class="Parameter">Subject</span>, <span class="Type">String</span>&#160;<span class="Parameter">Content</span>, <span class="Type">MailPriority</span>&#160;<span class="Parameter">Priority</span>)</td>
            </tr>
        </table>
        <p>
&#160;&#160;<br />This MISPL function returns 'True' if the email has been sent successfully.
</p>
        <p class="fieldlabel">Subject</p>
        <div class="indented">
            <p>A string with the subject of the mail.</p>
        </div>
        <p class="fieldlabel">Content</p>
        <div class="indented">
            <p>A string or a symbolic text reference : {&lt;text module}. </p>
            <div class="text_box_notes">
                <p><span style="color: #616E14; font-weight: bold;">Note</span>
                </p>
                <p>If you want to send a HTML mail (Internet mail only) the string should start with &lt;HTML&gt; and end with &lt;/HTML&gt;</p>
            </div>
        </div>
        <p class="fieldlabel">Priority</p>
        <div class="indented">
            <p>Indicates the importance of the mail. Can be specified with a number from 1 to 3 or by using the enumerated <span class="ui_element">MailPriority</span>.
</p>
            <ul>
                <li class="kadov-p" value="1">Low: MailPriority["Low"] or 1</li>
                <li class="kadov-p" value="2">Normal: MailPriority["Normal"] or 2</li>
                <li class="kadov-p" value="3">High: MailPriority["High"] or 3</li>
            </ul>
        </div>
        <h2>sc_Role.SendMail</h2>
        <p>Similar to the sc_User.SendMail function (see above), but allows  sending internal mails and/or emails to all <span class="ui_element">Users</span> which have been assigned a specific <span class="ui_element">Role</span> in the application. </p>
        <p>This makes it easier, for instance, to reach all system managers from within the application with a single message.</p>
        <h2><a name="General_SendMail" id="General_SendMail"></a>General SendMail</h2>
        <table style="border-collapse: separate;border-collapse: separate;" cellspacing="0" width="90%" border="1">
            <tr>
                <td style="width: 100%;padding-left: 3px;padding-top: 3px;padding-right: 3px;padding-bottom: 3px;"><span class="Type">Logical</span>&#160;<b>&#160;SendMail</b> (<span class="Type">String</span>&#160;<span class="Parameter">From</span>, <span class="Type">String</span>&#160;<span style="color: #008000;">To</span>, <span class="Type">String</span>&#160;<span class="Parameter">Subject</span>, <span class="Type">String</span>&#160;<span class="Parameter">Content</span>, <span class="Type">MailPriority</span>&#160;<span class="Parameter">Priority</span>)</td>
            </tr>
        </table>
        <p class="fieldlabel">From</p>
        <div class="indented">
            <p>Possible options</p>
            <ul>
                <li class="kadov-p" value="1"><span class="ui_element">USER</span> : the email address of the user currently logged in</li>
                <li class="kadov-p" value="2"><span class="ui_element">RESPONSIBLE</span> : the email address of the responsible for the employee/user currently logged in</li>
                <li class="kadov-p" value="3"><span class="ui_element">SITE</span> : the email address of the site</li>
                <li class="kadov-p" value="4">a valid e-mail address</li>
            </ul>
        </div>
        <p class="fieldlabel">To</p>
        <div class="indented">
            <p>If the value for parameter is an email address (contains @)</p>
            <ul>
                <li class="kadov-p" value="1">The mail will be sent via Internet</li>
                <li class="kadov-p" value="2">The <span class="ui_element">From</span> field should also be an e-mail address<ul><li class="kadov-p" value="1">If <span class="ui_element">From</span> is <span class="ui_element">USER</span>, the e-mail address of the current user will be used.</li><li class="kadov-p" value="2">If <span class="ui_element">From</span> is <span class="ui_element">SITE</span>, the e-mail address of the site will be used.</li></ul></li>
            </ul>
            <p>If the value for parameter is a user's login name</p>
            <ul>
                <li class="kadov-p" value="1">The mail will be internal database mail.</li>
                <li class="kadov-p" value="2">The <span class="ui_element">From</span> field is not important because the user currently logged in is the sender.</li>
            </ul>
        </div>
        <p class="fieldlabel">Subject</p>
        <div class="indented">
            <p>A string with the subject of the mail.</p>
        </div>
        <p class="fieldlabel">Content</p>
        <div class="indented">
            <p>A string or a symbolic text reference : {&lt;text module}. </p>
            <div class="text_box_notes">
                <p><span style="color: #616E14; font-weight: bold;">Note</span>
                </p>
                <p>If you want to send a HTML mail (Internet mail only) the string should start with &lt;HTML&gt; and end with &lt;/HTML&gt;</p>
            </div>
        </div>
        <p class="fieldlabel">Priority</p>
        <div class="indented">
            <p>Indicates the importance of the mail. Can be specified with a number from 1 to 3 or by using the enumerated <span class="ui_element">MailPriority</span>.
</p>
            <ul>
                <li class="kadov-p" value="1">Low: MailPriority["Low"] or 1</li>
                <li class="kadov-p" value="2">Normal: MailPriority["Normal"] or 2</li>
                <li class="kadov-p" value="3">High: MailPriority["High"] or 3</li>
            </ul>
        </div>
        <h2><a name="Additional_functions" id="Additional_functions"></a>Additional functions</h2>
        <p>Two other functions that may come in handy:</p>
        <ul>
            <li class="kadov-p" value="1"><span class="ui_element">GetCorrespondent</span>(correspondent internal id) : returns a correspondent id</li>
            <li class="kadov-p" value="2"><span class="ui_element">GetUser</span>(user login name) : returns a user id</li>
        </ul>
        <h2><a name="Logging" id="Logging"></a>Logging</h2>
        <p>GLIMS logs whether an email was successfully delivered to the mail server or not. </p>
        <p>A <span class="ui_element">LogType</span> record with the name <span class="ui_element">E-mail log</span> is created and outgoing mails from GLIMS are logged there. By default both successful and unsuccessful mail delivery operations are logged. The logging level can be controlled with the values of the <span class="ui_element">LogType</span> record.</p>
        <h2><a name="Examples" id="Examples"></a>Examples</h2>
        <div class="text_box_examples">
            <p><span style="color: #003366; font-weight: bold;">Example</span>
            </p>
            <p><span style="font-family: Courier;"><i>Correspondent Doctor;</i><br style="font-style: italic;" /><i>Doctor := GetCorrespondent("Doctor1");</i><br style="font-style: italic;" /><i>Doctor.SendMail("david@mips.be", "Patient report", "The patient is ill",&#160;</i><br style="font-style: italic;" /><i>MailPriority["High"]);</i></span>
                <br />
                <br />Sends a mail from "david@mips.be" to the e-mail address of 'Doctor1'.</p>
        </div>
        <div class="text_box_examples">
            <p><span style="color: #003366; font-weight: bold;">Example</span>
            </p>
            <p><span style="font-family: Courier;"><i>Correspondent Doctor;</i><br style="font-style: italic;" /><i>Doctor := GetCorrespondent("Doctor1");</i><br style="font-style: italic;" /><i>Doctor.SendMail("USER", "Patient report", "The patient is not so ill",&#160;</i><br style="font-style: italic;" /><i>MailPriority["Low"]);</i></span>
                <br />
                <br />Sends a mail from the e-mail address of the current user to the e-mail address of 'Doctor1'.</p>
        </div>
        <div class="text_box_examples">
            <p><span style="color: #003366; font-weight: bold;">Example</span>
            </p>
            <p><span style="font-family: Courier;"><i>sc_User UserId;</i><br style="font-style: italic;" /><i>UserId := GetUser("david");</i><br style="font-style: italic;" /><i>UserId.SendMail("Patient report", "The patient is not so ill", MailPriority["Low"]);</i></span>
                <br />
                <br />Sends a mail from the current user to the user 'david'. It will be internal mail if 'david' has 'internal' as mail method and external mail if david has 'external' as mail method (or two mails if 'both' is the mail method)</p>
        </div>
        <div class="text_box_examples">
            <p><span style="color: #003366; font-weight: bold;">Example</span>
            </p>
            <p><span style="font-family: Courier;"><i>String MailText;</i><br style="font-style: italic;" /><i>MailText:= "{&lt;ReportHeader}";</i><br style="font-style: italic;" /><i>.Issuer.SendMail("SITE", "report", MailText, 1)</i></span>
                <br />
                <br />Sends a mail from the e-mail address of the site to the e-mail address of the Issuer. The content of the e-mail will be the expanded text of the text module 'ReportHeader'.</p>
        </div>
        <div class="text_box_examples">
            <p><span style="color: #003366; font-weight: bold;">Example</span>
            </p>
            <p><span style="font-family: Courier;">String MailContent;<br></br>MailContent := "&lt;HTML&gt;&lt;H1&gt;Hallo David&lt;/H1&gt;&lt;/HTML&gt;";<br></br>SendMail("hans@mips.be", "david@mips.be", "subject", MailContent, MailPriority["Normal"]);</span>
                <br />
                <br />Sends a HTML e-mail from hans to david.</p>
        </div>
        <div class="text_box_examples">
            <p><span style="color: #003366; font-weight: bold;">Example</span>
            </p>
            <p><i>Issuer.SendMail("RESPONSIBLE", "subject", "The patient is ill, again", 3);</i>
                <br />
                <br />Sends a mail from the e-mail address of the HCProvider, responsible for the current user, to the e-mail address of the Issuer.</p>
        </div>
        <div class="text_box_examples">
            <p><span style="color: #003366; font-weight: bold;">Example</span>
            </p>
            <p><span style="font-family: Courier;font-style: italic;">.CreationUser.SendMail("subject", "Hello", MailPriority["Normal"]);</span>
                <br />
                <br />Sends a mail from the current user to the creation user.</p>
        </div>
    </body>
</html>