<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-gb" xml:lang="en-gb" data-mc-search-type="Stem" data-mc-help-system-file-name="index.xml" data-mc-path-to-help-system="../../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="" data-mc-file-tags="Status.CheckedContent,Status.Restyled" data-mc-priority="0" data-mc-time-estimate="0" data-mc-id="v55\english\mispl-text\independent mispl functions\function_datetime.htm">
    <!-- saved from url=(0016)http://localhost -->
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>Date and Time functions</title>
        <style>div.Section1
{
	page: Section1;
}

</style>
        <link href="../../../Resources/StyleSheets/shared.css" rel="stylesheet" type="text/css" />
        <script src="../../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/require.min.js" defer="defer" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/require.config.js" defer="defer" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/foundation.min.js" defer="defer" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/plugins.min.js" defer="defer" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAll.js" defer="defer" type="text/javascript">
        </script>
    </head>
    <body>
        <h1><a name="Top"></a>Date and Time functions</h1>
        <table border="0" width="75%" cellspacing="0" cellpadding="0">
            <tr>
                <td width="33%" valign="top">
                    <ul>
                        <li value="1"><a href="#DateAndTimeToDateTime">DateAndTimeToDateTime</a>
                        </li>
                        <li value="2"><a href="#DateDiffInYears">DateDiffInYears</a>
                        </li>
                        <li value="3"><a href="#DateTimeToDate">DateTimeToDate</a>
                        </li>
                        <li value="4"><a href="#DateTimeToString">DateTimeToString</a>
                        </li>
                    </ul>
                </td>
                <td width="33%" valign="top">
                    <ul>
                        <li value="1"><a href="#DateTimeToTime">DateTimeToTime</a>
                        </li>
                        <li value="2"><a href="#DateToString">DateToString</a>
                        </li>
                        <li value="3"><a href="#Now">Now</a>
                        </li>
                        <li value="4"><a href="#StringToDate">StringToDate</a>
                        </li>
                    </ul>
                </td>
                <td width="34%" valign="top">
                    <ul>
                        <li value="1"><a href="#StringToTime">StringToTime</a>
                        </li>
                        <li value="2"><a href="#TimeToString">TimeToString</a>
                        </li>
                        <li value="3"><a href="#Today">Today</a>
                        </li>
                    </ul>
                </td>
            </tr>
        </table>
        <h3><b><a name="DateAndTimeToDateTime"></a>DateAndTimeToDateTime <a href="#Top"><img border="0" src="../arrow.jpg" alt="Top" align="right" width="14" height="14" /></a></b>
        </h3>
        <blockquote>
            <p>This function combines a date and a time into a datetime.</p>
            <table border="1" width="90%" cellspacing="0">
                <tr>
                    <td width="100%"><i>Datetime</i><b>DateAndTimeToDateTime </b>(<i>Date</i><span style="color: #008000;">Date</span>,
        <i>
        Time</i><span style="color: #008000;">Time</span>)<br /><i>
        Fractional</i><b>DateAndTimeToDateTime </b>(<i>Date</i><span style="color: #008000;">Date</span>,
        <i>
        Integer</i><span style="color: #008000;">Time</span>)&#160;</td>
                </tr>
            </table>
        </blockquote>
        <blockquote>
            <p>The example below demonstrates how you can fetch
 the current date and time.</p>
            <table border="1" width="90%" cellspacing="0">
                <tr>
                    <td width="100%">DateAndTimeToDateTime (Today(), Now())&#160;</td>
                </tr>
            </table>
        </blockquote>
        <h3><b><a name="DateDiffInYears"></a>DateDiffInYears<a href="#Top"><img border="0" src="../arrow.jpg" alt="Top" align="right" width="14" height="14" /></a></b>
        </h3>
        <blockquote>
            <p>This function returns Date1-Date2
 in year units taking into account leap years. So 27/5/(x+1) - 27/5/(x) is always 1.</p>
            <table border="1" width="90%" cellspacing="0">
                <tr>
                    <td width="100%"><i>Fractional</i><b>DateDiffInYears </b>(<i>Date</i><span style="color: #008000;">Date1</span>,
        <i>
      Date</i><span style="color: #008000;">Date2</span>):&#160;</td>
                </tr>
            </table>
            <p><b>Note that Date1 must always exceed Date2.&#160; 
 If you do not know this beforehand, you can check this in a MISPL expression.&#160; 
 Example of to calculate the difference (in days) between two dates:</b>
            </p>
            <div class="Section1"><pre xml:space="preserve"><span lang="DE">if date1 &lt;&#160; date2 then
&#160;&#160; difference := -365 * DateDiffInYears(date2, date1) ;
else
&#160;&#160; difference := 365 * DateDiffInYears(date1, date2) ;
endif ;</span></pre>
                <p><span lang="de">If you do want a negative result, you must replace -365 
 by 365.</span>
                </p>
            </div>
        </blockquote>
        <h3><b><a name="DateTimeToDate"></a>DateTimeToDate<a href="#Top"><img border="0" src="../arrow.jpg" alt="Top" align="right" width="14" height="14" /></a></b>
        </h3>
        <blockquote>
            <p>This function returns the date part of DateTime.</p>
            <table border="1" width="90%" cellspacing="0">
                <tr>
                    <td width="100%"><i>Date</i><b>DateTimeToDate </b>({<i>Datetime</i>|<i>Fractional</i>} <span style="color: #008000;">DateTime</span>)</td>
                </tr>
            </table>
        </blockquote>
        <h3><b><a name="DateTimeToString"></a>DateTimeToString<a href="#Top"><img border="0" src="../arrow.jpg" alt="Top" align="right" width="14" height="14" /></a></b>
        </h3>
        <blockquote>
            <p>This function converts DateTime to a character string according to Format.</p>
            <table border="1" width="90%" cellspacing="0">
                <tr>
                    <td width="100%"><i>String</i><b>DateTimeToString </b>(<i>Datetime</i><span style="color: #008000;">DateTime</span>,
        <i>
        String</i><span style="color: #008000;">Format</span>)</td>
                </tr>
            </table>
            <dl>
                <dt><span style="color: #008000;">Format</span>
                </dt>
                <dd>Is a control string composed of zero or more directives and ordinary characters.
 A directive consists of a % character followed by a control character. All ordinary
 characters are copied unchanged to the target string. Control characters are listed under
 DateToString and TimeToString.</dd>
            </dl>
        </blockquote>
        <h3><b><a name="DateTimeToTime"></a>DateTimeToTime<a href="#Top"><img border="0" src="../arrow.jpg" alt="Top" align="right" width="14" height="14" /></a></b>
        </h3>
        <blockquote>
            <p>This function returns the time part of DateTime, i.e. the number of seconds since midnight.</p>
            <table border="1" width="90%" cellspacing="0">
                <tr>
                    <td width="100%"><i>Time</i><b>DateTimeToTime </b>(<i>Datetime</i><span style="color: #008000;">DateTime</span>)<br /><i>
        Integer</i><b>DateTimeToTime </b>(<i>Fractional</i><span style="color: #008000;">DateTime</span>)</td>
                </tr>
            </table>
        </blockquote>
        <h3><b><a name="DateToString"></a>DateToString<a href="#Top"><img border="0" src="../arrow.jpg" alt="Top" align="right" width="14" height="14" /></a></b>
        </h3>
        <blockquote>
            <p>This function converts Date to a character string according to Format.</p>
            <table border="1" width="90%" cellspacing="0">
                <tr>
                    <td width="100%"><a name="reporting option"></a><i>String</i><b>DateToString </b>(<i>Date</i> <span style="color: #008000;">Date</span>, <i> String</i><span style="color: #008000;">Format</span>)</td>
                </tr>
            </table>
            <dl>
                <dt><span style="color: #008000;">Format</span>&#160;</dt>
                <dd>Is a control string composed of zero or more directives and ordinary
 characters. A directive consists of a % character followed by a control
 character. All ordinary characters are copied unchanged to the target
 string.</dd>
            </dl>
            <table border="1" cellspacing="0" cellpadding="2" width="90%">
                <tr>
                    <td width="14%" valign="TOP"><b>Directive</b>
                    </td>
                    <td width="40%" valign="TOP"><b>Replaced by</b>
                    </td>
                    <td width="86%" valign="TOP"><b>Examples </b>(today is 07/06/2001)</td>
                </tr>
                <tr>
                    <td width="14%" valign="TOP">%a</td>
                    <td width="40%" valign="TOP">Abbreviated weekday name </td>
                    <td width="86%" valign="TOP" rowspan="13">DateToString(Today(),"%d/%m/%Y"); returns
 07/06/2001
        <p>DateToString(Today()-1,"%d/%m/%y"); returns 06/06/01</p></td>
                </tr>
                <tr>
                    <td width="14%" valign="TOP">%A</td>
                    <td width="40%" valign="TOP">Full weekday name</td>
                </tr>
                <tr>
                    <td width="14%" valign="TOP">%b</td>
                    <td width="40%" valign="TOP">Abbreviated month name </td>
                </tr>
                <tr>
                    <td width="14%" valign="TOP">%B</td>
                    <td width="40%" valign="TOP">Full month name</td>
                </tr>
                <tr>
                    <td width="14%" valign="TOP">%d</td>
                    <td width="40%" valign="TOP">Day of the month (00-31)</td>
                </tr>
                <tr>
                    <td width="14%" valign="TOP">%j</td>
                    <td width="40%" valign="TOP">Day of the year (001-366)</td>
                </tr>
                <tr>
                    <td width="14%" valign="TOP">%m</td>
                    <td width="40%" valign="TOP">Month as integer (01-12)</td>
                </tr>
                <tr>
                    <td width="14%" valign="TOP">%u&#160;<br /></td>
                    <td width="40%" valign="TOP">Weekday as a decimal number [1,7], with 1 representing Sunday.</td>
                </tr>
                <tr>
                    <td width="14%" valign="TOP">%U</td>
                    <td width="40%" valign="TOP">Week of the year (00-53, Sunday as first day of week) All
 days in a new year preceding the first Sunday are considered to be in week 0.</td>
                </tr>
                <tr>
                    <td width="14%" valign="TOP">%V</td>
                    <td width="40%" valign="TOP">The week number of the year (01-53, Monday as the first day
 of the week). If the week containing January 1st has four or more days in the new year,
 then it is considered week 1; otherwise, it is week 53 of the previous year, and the next
 week is week 1.</td>
                </tr>
                <tr>
                    <td width="14%" valign="TOP">%w&#160;</td>
                    <td width="40%" valign="TOP">Weekday as a decimal number [0,6], with 0 representing Sunday</td>
                </tr>
                <tr>
                    <td width="14%" valign="TOP">%W</td>
                    <td width="40%" valign="TOP">Week number of the year (00-53, Monday as the first day of
 the week). All days in a new year preceding the first Monday are considered to be in week
 0.</td>
                </tr>
                <tr>
                    <td width="14%" valign="TOP">%x</td>
                    <td width="40%" valign="TOP">Local date representation (%d/%m/%y)</td>
                </tr>
                <tr>
                    <td width="14%" valign="TOP">%y</td>
                    <td width="40%" valign="TOP">Year without century (0-99)</td>
                </tr>
                <tr>
                    <td width="14%" valign="TOP">%Y</td>
                    <td width="40%" valign="TOP">Year with century</td>
                </tr>
            </table>
        </blockquote>
        <h3><a name="Now"></a>Now<b><a href="#Top"><img border="0" src="../arrow.jpg" alt="Top" align="right" width="14" height="14" /></a></b></h3>
        <blockquote>
            <p><span style="color: #000000;">This function returns the current time as determined 
 by the environment variable "MA_TimeSource":</span>
            </p>
            <ul>
                <li value="1">If not set, the current time of the server is used (more specifically 
 the server that contains the genrw-database)</li>
                <li value="2">If set to "LOCAL", the current time of the local PC is used (which we do 
 not recommend unless you have serious performance issues)</li>
                <li value="3">You can also specify a database name.&#160; The current time of the 
 server containing that database will be assumed.</li>
            </ul>
            <table border="1" width="90%" cellspacing="0">
                <tr>
                    <td width="100%"><span style="color: #000000;"><i>Time</i><b>Now </b>()</span>
                    </td>
                </tr>
            </table>
        </blockquote>
        <h3><b><a name="StringToDate"></a>StringToDate<a href="#Top"><img border="0" src="../arrow.jpg" alt="Top" align="right" width="14" height="14" /></a></b>
        </h3>
        <blockquote>
            <p>This function convert DateString (DD/MM/[YY]YY format ) to a date.</p>
            <p>[YY]YY is an integer of 2 or 4 digits.&#160; A two-digit specification is
 interpreted according to the -yy Progress startup parameter.&#160; The -yy
 parameter indicates the start of a 100-year period in which any two-digit date
 value is defined. When -yy is set at 1950 (the default), it is determined if
 the two-digit value in the date is greater or less than 50. If the date value
 is greater than 50, it is interpreted as a date for the twentieth century. If
 the date value is less than 50, it is interpreted as a date for the
 twenty-first century. For example, if you start Progress with -yy 1950, years
 50-99 are treated as 1950-1999, and years 00-49 are treated as 2000-2049. For
 more information about the Progress date format, see the chapter on startup
 parameters in the Progress Startup Command and Parameter Reference.</p>
            <table border="1" width="90%" cellspacing="0">
                <tr>
                    <td width="100%"><i>Date</i><b>StringToDate </b>(<i>String</i><span style="color: #008000;">DateString</span>)</td>
                </tr>
            </table>
        </blockquote>
        <h3><b><a name="StringToTime"></a>StringToTime<a href="#Top"><img border="0" src="../arrow.jpg" alt="Top" align="right" width="14" height="14" /></a></b>
        </h3>
        <blockquote>
            <p>This function converts TimeString (HH[:MM[:SS]] format) to a time.</p>
            <table border="1" width="90%" cellspacing="0">
                <tr>
                    <td width="100%"><i>Time</i><b>StringToTime </b>(<i>String</i><span style="color: #008000;">TimeString</span>)</td>
                </tr>
            </table>
        </blockquote>
        <h3><b><a name="TimeToString"></a>TimeToString<a href="#Top"><img border="0" src="../arrow.jpg" alt="Top" align="right" width="14" height="14" /></a></b>
        </h3>
        <blockquote>
            <p>This function converts Time (number of seconds since midnight) to a character string, according to
 Format.</p>
            <table border="1" width="90%" cellspacing="0">
                <tr>
                    <td width="100%"><i>String</i><b>TimeToString </b>({<i>Time</i>|<i>Integer</i>} <span style="color: #008000;">Time</span>,
        <i>
        String</i><span style="color: #008000;">Format</span>)</td>
                </tr>
            </table>
            <dl>
                <dt><span style="color: #008000;">Format</span>&#160;</dt>
                <dd>Is composed of zero or more directives and ordinary characters. A directive
 consists of a % character followed by a control character. All ordinary characters are
 copied unchanged to the target string.</dd>
            </dl>
            <table border="1" cellspacing="0" cellpadding="2" width="90%">
                <tr>
                    <td width="14%" valign="TOP"><b>Directive</b>
                    </td>
                    <td width="40%" valign="TOP"><b>Replaced by</b>
                    </td>
                    <td width="89%" valign="TOP"><b>Examples </b>(current time is
 11:05)</td>
                </tr>
                <tr>
                    <td width="14%" valign="TOP">%H</td>
                    <td width="40%" valign="TOP">Hour (00-23)</td>
                    <td width="89%" valign="TOP">TimeToString (Now(), "%H:%M");
 returns 11:05</td>
                </tr>
                <tr>
                    <td width="14%" valign="TOP">%M</td>
                    <td width="40%" valign="TOP">Minutes (00-59)</td>
                    <td width="89%" valign="TOP">TimeToString (Now() -3600, "%H h %M
 min");&#160;<br />      returns 10 h 05 min</td>
                </tr>
                <tr>
                    <td width="14%" valign="TOP">%S</td>
                    <td width="40%" valign="TOP">Seconds (00-59)</td>
                    <td width="89%" valign="TOP">&#160;</td>
                </tr>
                <tr>
                    <td width="14%" valign="TOP">%X</td>
                    <td width="40%" valign="TOP">Local time representation (%H:%M:%S)</td>
                    <td width="89%" valign="TOP">TimeToString (Now() +1800, "%X");
 returns 11:35:00</td>
                </tr>
            </table>
        </blockquote>
        <h3><a name="Today"></a>Today<b><a href="#Top"><img border="0" src="../arrow.jpg" alt="Top" align="right" width="14" height="14" /></a></b></h3>
        <blockquote>
            <p><span style="color: #000000;">This function returns the current date as determined 
 by the environment variable "MA_TimeSource":</span>
            </p>
            <ul>
                <li value="1">If not set, the current date of the server is used (more specifically 
 the server that contains the genrw-database)</li>
                <li value="2">If set to "LOCAL", the current date of the local PC is used (which we do 
 not recommend unless you have serious performance issues)</li>
                <li value="3">You can also specify a database name.&#160; The current date of the 
 server containing that database will be assumed.</li>
            </ul>
            <table border="1" width="90%" cellspacing="0">
                <tr>
                    <td width="100%"><i>Date</i><b>Today</b>()</td>
                </tr>
            </table>
        </blockquote>
    </body>
</html>