<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-gb" xml:lang="en-gb" data-mc-search-type="Stem" data-mc-help-system-file-name="index.xml" data-mc-path-to-help-system="../../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="" data-mc-file-tags="Status.CheckedContent,Status.Restyled" data-mc-priority="0" data-mc-time-estimate="0" data-mc-id="v55\english\mispl-text\independent mispl functions\function_miscellaneous.htm">
    <!-- saved from url=(0016)http://localhost -->
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>Miscellaneous functions</title>
        <link href="../../../Resources/StyleSheets/shared.css" rel="stylesheet" type="text/css" />
        <script src="../../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/require.min.js" defer="defer" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/require.config.js" defer="defer" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/foundation.min.js" defer="defer" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/plugins.min.js" defer="defer" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAll.js" defer="defer" type="text/javascript">
        </script>
    </head>
    <body>
        <h1><a name="Top" id="Top"></a>Miscellaneous functions</h1>
        <table cellspacing="0" width="100%">
            <tr>
                <td style="vertical-align: top;width: 33%;padding-left: 0px;padding-top: 0px;padding-right: 0px;padding-bottom: 0px;">
                    <ul>
                        <li class="kadov-p" value="1"><a href="#AddLogEntry">AddLogEntry</a>
                        </li>
                        <li class="kadov-p" value="2"><a href="#CurrentDepartment">CurrentDepartment</a>
                        </li>
                        <li class="kadov-p" value="3"><a href="#CurrentRole">CurrentRole</a>
                        </li>
                        <li class="kadov-p" value="4"><b><a href="#CurrentOS">CurrentOS</a></b>
                        </li>
                        <li class="kadov-p" value="5"><a href="#CurrentD">CurrentDevice</a>
                        </li>
                        <li class="kadov-p" value="6"><b><a href="#CurrentT">CurrentTerminal</a></b>
                        </li>
                        <li class="kadov-p" value="7"><a href="#CurrentUser">CurrentUser</a>
                        </li>
                        <li class="kadov-p" value="8"><a href="#DatedIdentifier">DatedIdentifier</a>
                        </li>
                    </ul>
                </td>
                <td style="vertical-align: top;width: 33%;padding-left: 0px;padding-top: 0px;padding-right: 0px;padding-bottom: 0px;">
                    <ul>
                        <li class="kadov-p" value="1"><a href="#GetCode">GetCode</a>
                        </li>
                        <li class="kadov-p" value="2"><a href="#GetCorrespondent">GetCorrespondent</a>
                        </li>
                        <li class="kadov-p" value="3"><a href="#GetCorrespondentId">GetCorrespondentId</a>
                        </li>
                        <li class="kadov-p" value="4"><a href="#GetLogEntry">GetLogEntry</a>
                        </li>
                        <li class="kadov-p" value="5"><a href="#GetObjectId">GetObjectId</a>
                        </li>
                        <li class="kadov-p" value="6"><a href="#GetPrinterId">GetPrinterId</a>
                        </li>
                        <li class="kadov-p" value="7"><a href="#GetSiteAttribute">GetSiteAttribute</a>
                        </li>
                        <li class="kadov-p" value="8"><a href="#GetUser">GetUser</a>
                        </li>
                        <li class="kadov-p" value="9"><a href="#Glims">Glims</a>
                        </li>
                    </ul>
                </td>
                <td style="vertical-align: top;width: 34%;padding-left: 0px;padding-top: 0px;padding-right: 0px;padding-bottom: 0px;">
                    <ul>
                        <li class="kadov-p" value="1"><a href="#Identifier">Identifier</a>
                        </li>
                        <li class="kadov-p" value="2"><a href="#IsHoliday">IsHoliday</a>
                        </li>
                        <li class="kadov-p" value="3"><a href="#NextValue">NextValue</a>
                        </li>
                        <li class="kadov-p" value="4"><a href="#NumberToStringInFull">NumberToStringInFull</a>
                        </li>
                        <li class="kadov-p" value="5"><a href="#SendMail">SendMail</a>
                        </li>
                        <li class="kadov-p" value="6"><a href="#SetSiteAttribute">SetSiteAttribute</a>
                        </li>
                        <li class="kadov-p" value="7"><a href="#Translate">Translate</a>
                        </li>
                    </ul>
                </td>
            </tr>
        </table>
        <h3><a name="AddLogEntry" id="AddLogEntry"></a>AddLogEntry<a href="#Top"><img src="../arrow.jpg" alt="Top" title="Top" width="14" height="14" align="right" border="0" /></a></h3>
        <p style="margin-left: 40px;">This MISPL function allows creating new log 
 entries.</p>
        <table style="margin-left: 40px;border-collapse: separate;border-collapse: separate;" cellspacing="0" width="90%" border="1">
            <tr>
                <td style="width: 100%;"><b><span style="font-style: italic;font-weight: normal;">Logical</span> <span style="font-weight: bold;">AddLogEntry</span><span style="font-style: italic;font-weight: normal;">(String</span><span style="color: #008000;font-weight: normal;">TableName</span><span style="font-style: italic;font-weight: normal;">, PositiveInteger</span> <span style="color: #008000;font-weight: normal;">RecordId</span><span style="font-style: italic;font-weight: normal;">, String</span> <span style="color: #008000;font-weight: normal;">LogTypeName</span><span style="font-style: italic;font-weight: normal;">, LogSeverity</span> <span style="color: #008000;font-weight: normal;">LogSeverity</span><span style="font-style: italic;font-weight: normal;">, Logical</span> <span style="color: #008000;font-weight: normal;">NeedsChecking</span><span style="font-style: italic;font-weight: normal;">, String</span> <span style="color: #008000;font-weight: normal;">LogMessage</span><span style="font-style: italic;font-weight: normal;">)</span> &#160;</b>
                </td>
            </tr>
        </table>
        <p style="margin-left: 40px;"><span style="font-style: italic;">L</span><span style="font-style: italic;">ogSeverity</span> <span style="color: #008000;">LogSeverity</span></p>
        <p style="margin-left: 80px;">One of: <span style="color: #008000;">Info, 
 Warning, Error</span></p>
        <h3><b><a name="CurrentDepartment" id="CurrentDepartment"></a>CurrentDepartment 
 <a href="#Top"><img src="../arrow.jpg" alt="Top" title="Top" width="14" height="14" align="right" border="0" /></a></b>
        </h3>
        <blockquote>
            <p>This function returns the department mnemonic of the user.</p>
            <table style="border-collapse: separate;border-collapse: separate;" cellspacing="0" width="90%" border="1">
                <tr>
                    <td style="width: 100%;"><i style="font-style: italic;">String</i> <b>CurrentDepartment</b>() 
		 <b>&#160;</b></td>
                </tr>
            </table>
        </blockquote>
        <h3><b><a name="CurrentRole"></a>CurrentRole</b>
        </h3>
        <blockquote>
            <p>This function returns the mnemonic of the role selected by the user 
 during login.</p>
            <table style="border-collapse: separate;border-collapse: separate;" cellspacing="0" width="90%" border="1">
                <tr>
                    <td style="width: 100%;"><i style="font-style: italic;">String</i> <b>CurrentRole</b>() <b>&#160;</b></td>
                </tr>
            </table>
        </blockquote>
        <h3><b><a name="CurrentOS"></a>CurrentOS</b><b><a href="#Top"><img src="../arrow.jpg" alt="Top" title="Top" width="14" height="14" align="right" border="0" /></a></b>
        </h3>
        <blockquote>
            <p>This function returns the name of the current operating system, i.e. 
 either the string "UNIX" or the string "WINDOWS". 
 &#160;This function is useful to decide what kind of file path syntax 
 is to be used when creating filenames from within MISPL.</p>
            <table style="border-collapse: separate;border-collapse: separate;" cellspacing="0" width="90%" border="1">
                <tr>
                    <td style="width: 100%;"><i style="font-style: italic;">String</i> <b>CurrentOS</b>() <b>&#160;</b></td>
                </tr>
            </table>
        </blockquote>
        <h3><a name="CurrentD"></a><b>CurrentDevice<a href="#Top"><img src="../arrow.jpg" alt="Top" title="Top" width="14" height="14" align="right" border="0" /></a></b>
        </h3>
        <p style="margin-left: 40px;">This MISPL function complements the MISPL function 'CurrentTerminal' (see below) and returns the client device name (if applicable).</p>
        <blockquote>
            <table id="table2" style="border-collapse: separate;border-collapse: separate;" cellspacing="0" width="90%" border="1">
                <tr>
                    <td style="width: 100%;"><i style="font-style: italic;">String</i><b>Current</b><b>Device</b>()</td>
                </tr>
            </table>
        </blockquote>
        <h3><a name="CurrentT"></a><b>CurrentTerminal<a href="#Top"><img src="../arrow.jpg" alt="Top" title="Top" width="14" height="14" align="right" border="0" /></a></b>
        </h3>
        <p style="margin-left: 40px;">This MISPL function returns the name of the 
 current user's terminal as shown in the lower status bar of the user interface. 
 Note that the returned value will be unknown when the current process 
 is running in the background (e.g. brokers or task schedulers)</p>
        <blockquote>
            <table id="table2" style="border-collapse: separate;border-collapse: separate;" cellspacing="0" width="90%" border="1">
                <tr>
                    <td style="width: 100%;"><i style="font-style: italic;">String</i> <b>Current</b><b><span style="font-weight: 700;">Terminal</span></b>()</td>
                </tr>
            </table>
        </blockquote>
        <h3><a name="CurrentUser" id="CurrentUser"></a>CurrentUser<a href="#Top"><img src="../arrow.jpg" alt="Top" title="Top" width="14" height="14" align="right" border="0" /></a></h3>
        <p style="margin-left: 40px;">This function yields the login name of the 
 current user as a string.</p>
        <table style="margin-left: 40px;border-collapse: separate;border-collapse: separate;" cellspacing="0" width="90%" border="1">
            <tr>
                <td style="width: 100%;"><span style="font-style: italic;">String</span> <span style="font-weight: bold;">CurrentUser</span><span style="font-style: italic;">()</span></td>
            </tr>
        </table>
        <h3><a name="DatedIdentifier" id="DatedIdentifier"></a>DatedIdentifier<b><a href="#Top"><img src="../arrow.jpg" alt="Top" title="Top" width="14" height="14" align="right" border="0" /></a></b></h3>
        <div class="indented">
            <p>This function is an extension of the <a href="#Identifier">Identifier</a> 
 function and can be used if the returned identifier should increment in 
 accordance with the time.&#160;&#160;The date specified by the Date parameter 
 will have to be higher than the increment time that is logged for each 
 sequence.&#160;&#160;(Site -&gt; System management -&gt; Scheme -&gt; 
 Sequences).</p>
            <table style="border-collapse: separate;border-collapse: separate;" cellspacing="0" width="90%" border="1">
                <tr>
                    <td style="width: 100%;"><i style="font-style: italic;">String</i> <b>Dated</b><b>Identifier</b> (<i>String</i><span style="color: #008000;">SequencePrefix</span>, 
		 <i>String</i><span style="color: #008000;">IdentifierPrefix</span>, <i>Integer</i> <span style="color: #008000;">DigitCount</span>, Fractional <span style="color: #008000;">Date)</span></td>
                </tr>
            </table>
            <p>This function can e.g. be used for invoices.&#160;&#160;The Date parameter 
 could then be the external date of the invoice.&#160;&#160;If so, all 
 invoice identifiers will increment in accordance with the time.&#160;&#160;It 
 will be impossible for a previous invoice to have a higher identifier 
 than a more recent invoice.</p>
        </div>
        <h3><a name="GetCode"></a>GetCode</h3>
        <p>This function returns a code for a specific table, record, and coding system.</p>
        <p><span style="font-style: italic;">String</span><span style="font-weight: bold;">GetCode</span><span style="font-style: italic;">(String</span> <span style="color: #008000;">TableName</span>, <span style="font-style: italic;">Integer</span> <span style="color: #008000;">RecordId</span>, <span style="font-style: italic;">String</span> <span style="color: #008000;">CodingSystemMnemonic</span><span style="font-style: italic;">)</span></p>
        <p style="margin-left: 40px;"><span style="font-style: italic;">String</span> <span style="color: #008000;">TableName</span></p>
        <p style="margin-left: 80px;">The table which the code is for. This value is mandatory.</p>
        <p style="margin-left: 40px;"><span style="font-style: italic;">Integer</span> <span style="color: #008000;">RecordId</span></p>
        <p style="margin-left: 80px;">The specific record to find the code of. This value is mandatory.</p>
        <p style="margin-left: 40px;"><span style="font-style: italic;">String</span> <span style="color: #008000;">CodingSystemMnemonic</span></p>
        <p style="margin-left: 80px;">The mnemonic of the coding system which is to be used to retrieve the correct code. This value is mandatory.</p>
        <div class="text_box_examples" xmlns="http://www.w3.org/1999/xhtml">
            <p><span style="color: #003366; font-weight: bold;">Examples</span>
            </p>
            <p xmlns=""> To retrieve the Orphanet code of the disorder related to a certain GeneticExam:</p>
            <div class="indented" xmlns="">
                <p>RETURN GetCode("Disorder", .GeneticProcedure.Disorder, "ORPHANET") ;</p>
            </div>
            <p xmlns="">To retrieve the CLINVAR code of a variant result:</p>
            <div class="indented" xmlns="">
                <p>RETURN GetCode("Variant", .Variant, "CLINVAR") ;</p>
            </div>
            <p xmlns="">To retrieve the OMIM code of the gene where a variant was found:</p>
            <div class="indented" xmlns="">
                <p>RETURN GetCode("Gene", .Variant.Locus, "OMIM") ;</p>
            </div>
        </div>
        <h3><a name="GetCorrespondent" id="GetCorrespondent"></a>GetCorrespondent<a href="#Top"><img src="../arrow.jpg" alt="Top" title="Top" width="14" height="14" align="right" border="0" /></a></h3>
        <p style="margin-left: 40px;">This function searches for a correspondent 
 by its internal id. If a correspondent is found the function returns the 
 id of the correspondent record.</p>
        <table style="margin-left: 40px;border-collapse: separate;border-collapse: separate;" cellspacing="0" width="90%" border="1">
            <tr>
                <td style="width: 100%;"><b>&#160;</b><span style="font-style: italic;">Correspondent</span><span style="font-weight: bold;">GetCorrespondent</span> <span style="font-style: italic;">(String</span><span style="color: #008000;">InternalId</span><span style="font-style: italic;">)</span></td>
            </tr>
        </table>
        <h3><a name="GetCorrespondentId" id="GetCorrespondentId"></a>GetCorrespondentId<a href="#Top"><img src="../arrow.jpg" alt="Top" title="Top" width="14" height="14" align="right" border="0" /></a></h3>
        <p style="margin-left: 40px;">This function returns a reference to the 
 correspondent that meets the specified criteria.</p>
        <table style="margin-left: 40px;border-collapse: separate;border-collapse: separate;" cellspacing="0" width="90%" border="1">
            <tr>
                <td style="width: 100%;"><b>&#160;&#160;</b><span style="font-style: italic;">Correspondent</span><span style="font-weight: bold;">GetCorrespondentId</span> <span style="font-style: italic;">(String</span><span style="color: #008000;">InternalId</span><span style="font-style: italic;">, CorrespondentType</span><span style="color: #008000;">Type</span><span style="font-style: italic;">)</span></td>
            </tr>
        </table>
        <p style="margin-left: 40px;"><span style="font-style: italic;">String</span> <span style="color: #008000;">InternalId</span></p>
        <p style="margin-left: 80px;">Correspondent's internal id</p>
        <p style="margin-left: 40px;"><span style="font-style: italic;">CorrespondentType</span> <span style="color: #008000;">Type</span></p>
        <p style="margin-left: 80px;">One of: Person, Organization, HCProvider, 
 Ward, Institution, Lab, Department, Firm, Fund, Health office, Company, 
 Bank, Study<span style="margin-left: 80px;"><br />Correspondent's type. If not specified and the internal id is not unique, 
 no correspondent reference will be returned.</span></p>
        <h3><a name="GetLogEntry" id="GetLogEntry"></a>GetLogEntry<a href="#Top"><img src="../arrow.jpg" alt="Top" title="Top" width="14" height="14" align="right" border="0" /></a></h3>
        <p style="margin-left: 40px;">This function accesses a log entry record 
 based on the input parameters: when successful then a reference to the 
 record is returned, otherwise "?".</p>
        <table style="margin-left: 40px;border-collapse: separate;border-collapse: separate;" cellspacing="0" width="90%" border="1">
            <tr>
                <td style="width: 100%;"><span style="font-style: italic;">lg_Entry</span> <span style="font-weight: bold;">GetLogEntry</span><span style="font-style: italic;">(String</span> <span style="color: #008000;">TableName</span><span style="font-style: italic;">, 
		 PositiveInteger</span><span style="color: #008000;">RecordId</span><span style="font-style: italic;">, String</span><span style="color: #008000;">LogTypeName</span><span style="font-style: italic;">, Logical</span><span style="color: #008000;">NeedsChecking</span><span style="font-style: italic;">, LogSeverity</span><span style="color: #008000;">LogSeverity</span><span style="font-style: italic;">, DateTime</span><span style="color: #008000;">CreatedAfter</span><span style="font-style: italic;">, DateTime</span><span style="color: #008000;">CreatedBefore</span><span style="font-style: italic;">, String</span><span style="color: #008000;">MessageMatchString</span><span style="font-style: italic;">, PositiveInteger</span><span style="color: #008000;">SeqNo</span><span style="font-style: italic;">)</span></td>
            </tr>
        </table>
        <p style="margin-left: 40px;"><span style="font-style: italic;">String</span> <span style="color: #008000;">TableName</span></p>
        <p style="margin-left: 80px;text-align: left;">Name of table to which the log entry record 
 should point. <span style="margin-left: 40px;"><br />This value is mandatory.</span></p>
        <p style="margin-left: 40px;text-align: left;"><span style="font-style: italic;">PositiveInteger</span> <span style="color: #008000;">RecordId</span></p>
        <p style="margin-left: 80px;text-align: left;">Id of record to which the log entry record 
 should point. <span style="margin-left: 40px;"><br />This value is mandatory.</span></p>
        <p style="margin-left: 40px;text-align: left;"><span style="font-style: italic;">String</span> <span style="color: #008000;">LogTypeName</span></p>
        <p style="margin-left: 80px;text-align: left;">Name of log type of the log entry record 
 (optional)</p>
        <p style="margin-left: 40px;text-align: left;"><span style="font-style: italic;">Logical</span> <span style="color: #008000;">NeedsChecking</span></p>
        <p style="margin-left: 80px;text-align: left;">Corresponds with the log entry's NeedsChecking 
 value (optional)</p>
        <p style="margin-left: 40px;text-align: left;"><span style="font-style: italic;">LogSeverity</span> <span style="color: #008000;">LogSeverity</span></p>
        <p style="margin-left: 80px;">One of: <span style="color: #008000;">Info, 
 Warning, Error</span><br />Corresponds with the log entry's Severity value (optional)</p>
        <p style="margin-left: 40px;">DateTime <span style="color: #008000;">CreatedAfter</span></p>
        <p style="margin-left: 80px;">Log entry must have been created after this 
 specified date and time (optional)</p>
        <p style="margin-left: 40px;">DateTime <span style="color: #008000;">CreatedBefore</span></p>
        <p style="margin-left: 80px;">Log entry must have been created before this 
 specified date and time (optional)</p>
        <p style="margin-left: 40px;">String <span style="color: #008000;">MessageMatchString</span></p>
        <p style="margin-left: 80px;">String which must match the log entry's message. 
 <span style="margin-left: 40px;"><br />Wild card support.</span></p>
        <p style="margin-left: 40px;">PositiveInteger <span style="color: #008000;">SeqNo</span></p>
        <p style="margin-left: 80px;">Indicates whether the first, the second, 
 ... log entry must be fetched which meets the specified criteria. <span style="margin-left: 40px;"><br />The retrieval order is by CreationTime, seqno=1 indicates that the most 
 recent created log entry is fetched.</span></p>
        <h3><a name="GetObjectId" id="GetObjectId"></a>GetObjectId<b><a href="#Top"><img src="../arrow.jpg" alt="Top" title="Top" width="14" height="14" align="right" border="0" /></a></b></h3>
        <blockquote>
            <p>This function returns a reference to the object that meets the specified 
 criteria.</p>
            <table style="border-collapse: separate;border-collapse: separate;" cellspacing="0" width="90%" border="1">
                <tr>
                    <td style="width: 100%;"><span class="Type">Object</span> <b>GetObjectId</b> 
		 (<span class="Type"><i>String</i></span>&#160;<span class="Parameter"><span style="color: #008000;">InternalId</span></span>, <span class="Type"><i>ObjectType</i></span>&#160;<span class="Parameter"><span style="color: #008000;">Type</span></span>)</td>
                </tr>
            </table>
        </blockquote>
        <blockquote>
            <dl>
                <dt><span class="Type">String</span>&#160;<span class="Parameter"><span style="color: #008000;">InternalId</span></span></dt>
                <dd>Object's internal id<br />	&#160;</dd>
                <dt><span class="Type">ObjectType</span>&#160;<span class="Parameter"><span style="color: #008000;">Type</span></span></dt>
                <dd>One of: <span class="Parameter">Animal, Lot, Person, Unknown, QC 
	 lot</span>.&#160;&#160;An object reference will only be returned if 
	 the type matches or if no type is specified. Two alternative syntaxes 
	 can be used (example for object type 'Person'):</dd>
            </dl>
            <blockquote>
                <ul>
                    <li class="kadov-p" value="1">ObjectType["Person"]</li>
                    <li class="kadov-p" value="2">StringToEnumerated("ObjectType", "Person")</li>
                </ul>
            </blockquote>
        </blockquote>
        <h3><b><a name="GetPrinterId" id="GetPrinterId"></a>GetPrinterId<a href="#Top"><img src="../arrow.jpg" alt="Top" title="Top" width="14" height="14" align="right" border="0" /></a></b>
        </h3>
        <p xmlns="http://www.w3.org/1999/xhtml">A SpecificSite-based MISPL function <a href="../../../db/reference_guide/ssit.htm#M_GetPrinterId" xmlns="">GetPrinterId</a> is available. It takes a PrinterName as input parameter and returns the PrinterId of the printer in question.</p>
        <p xmlns="http://www.w3.org/1999/xhtml">The purpose of this function is the following one: The table 'Order' has a widely-used function, <a href="../../../db/reference_guide/ord.htm#M_PrintLabels" xmlns="">PrintLabels</a>. This function has several parameters, one of which being "LabelPrinterId". The value of this parameter should be retrieved using <a href="../../../db/reference_guide/ssit.htm#M_GetPrinterId" xmlns="">GetPrinterId</a> as a built-in function. This is illustrated below:</p>
        <div class="text_box_examples" xmlns="http://www.w3.org/1999/xhtml">
            <p><span style="color: #003366; font-weight: bold;">Example</span>
            </p>
            <p xmlns=""><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="function_miscellaneous_getprinterid.png"><img class="MCPopupThumbnail img imgLargeImage" data-mc-width="711" data-mc-height="668" src="function_miscellaneous_getprinterid_thumb_0_120.png" tabindex="" /></a>
            </p>
            <p><b>MISPL</b>
            </p>
            <p>rp_Printer ThePrinter;</p>
            <p>ThePrinter := GetPrinterId("NotePad");</p>
            <p>.PrintLabels(NO,NO,?,NO,YES,YES,1,NO,NO, ThePrinter);</p>
            <p>RETURN YES;</p>
        </div>
        <h3><b><a name="GetSiteAttribute" id="GetSiteAttribute"></a>GetSiteAttribute<a href="#Top"><img src="../arrow.jpg" alt="Top" title="Top" width="14" height="14" align="right" border="0" /></a></b>
        </h3>
        <blockquote>
            <table style="border-collapse: separate;border-collapse: separate;" cellspacing="0" width="90%" border="1">
                <tr>
                    <td style="width: 100%;"><i style="font-style: italic;">String</i> <b>GetSiteAttribute</b> (<i>String</i><span style="color: #008000;">Table</span>, 
		 <i>Integer</i><span style="color: #008000;">RecordId</span>, <i>String</i> <span style="color: #008000;">AttributeName</span>)</td>
                </tr>
            </table>
            <p><b style="font-weight: bold;">Example:&#160;</b>
            </p>
            <table style="border-collapse: separate;border-collapse: separate;" cellspacing="0" width="90%" border="1">
                <tr>
                    <td style="width: 100%;">MaterialType := GetSiteAttribute("Material", 
		 .Material.Id, "Type") ;</td>
                </tr>
            </table>
            <p><b style="font-weight: bold;">Remark:</b>
            </p>
            <p>A site attribute of data type 'Reference'allows to define a data type 
 whose value actually refers to another record in another table.&#160;&#160;To 
 navigate to this record via MISPL, the &lt;AttributeName&gt; parameter 
 of the GetSiteAtttribute MISPL function can contain the path to a field 
 of the referred record, using the "AttributeName.FieldName" 
 syntax.&#160;&#160;</p>
            <p>Example, when "Boss" is the name of a User-based site attribute 
 referring to another user, the following call would return the initials 
 of a user's boss:</p>
            <blockquote><pre>
RETURN GetSiteAttribute("sc_User", .Id, "Boss.Initials")</pre>
            </blockquote>
            <p>Note that &lt;FieldName&gt; can contain a valid path to any field to 
 which the program can navigate WITHOUT USING FUNCTIONS. Example:</p>
            <blockquote><pre>
RETURN GetSiteAttribute("sc_User", .Id, "Boss.Language.Name") would return the name of the language of the user's boss.</pre>
            </blockquote>
        </blockquote>
        <h3><a name="GetUser" id="GetUser"></a>GetUser<a href="#Top"><img src="../arrow.jpg" alt="Top" title="Top" width="14" height="14" align="right" border="0" /></a></h3>
        <p style="margin-left: 40px;">This function searches for a user by its 
 login name. It returns a user id.</p>
        <table style="margin-left: 40px;border-collapse: separate;border-collapse: separate;" cellspacing="0" width="90%" border="1">
            <tr>
                <td style="width: 100%;">sc_User <span style="font-weight: bold;">GetUser</span> 
		 (<span style="font-style: italic;">String</span><span style="color: #008000;">LoginName</span>)</td>
            </tr>
        </table>
        <h3><a name="Glims" id="Glims"></a>Glims<a href="#Top"><img src="../arrow.jpg" alt="Top" title="Top" width="14" height="14" align="right" border="0" /></a></h3>
        <p style="margin-left: 40px;">This functions provides access to the Glims 
 specific site record.<br />Example: RETURN IfKnownString(Glims().Organization.Name);</p>
        <table style="margin-left: 40px;border-collapse: separate;border-collapse: separate;" cellspacing="0" width="90%" border="1">
            <tr>
                <td style="width: 100%;"><span style="font-style: italic;">SpecificSite</span> <span style="font-weight: bold;">Glims</span><span style="font-style: italic;">()</span></td>
            </tr>
        </table>
        <h3><a name="Identifier" id="Identifier"></a>Identifier<b><a href="#Top"><img src="../arrow.jpg" alt="Top" title="Top" width="14" height="14" align="right" border="0" /></a></b></h3>
        <blockquote>
            <p>This function returns a unique identifier, composed of the IdentifierPrefix 
 and a suffix of DigitCount digits. The suffix shows the new value of the 
 sequencer named ‘&lt;SequencePrefix&gt;&lt;IdentifierPrefix&gt;’. If this 
 sequencer doesn’t exist, it is automatically created and its value initialized 
 to 1.</p>
            <table style="border-collapse: separate;border-collapse: separate;" cellspacing="0" width="90%" border="1">
                <tr>
                    <td style="width: 100%;"><i style="font-style: italic;">String</i> <b>Identifier</b> (<i>String</i><span style="color: #008000;">SequencePrefix</span>, 
		 <i>String</i><span style="color: #008000;">IdentifierPrefix</span>, <i>Integer</i> <span style="color: #008000;">DigitCount</span>)</td>
                </tr>
            </table>
            <p>Example of an OrderInternalId using the Identifier function:</p>
            <p>Identifier("Order", DateToString(Today(), "%Y%m%d") 
 + "-", 5) could yield an order internal id 20010131-00004.&#160;&#160;&#160;"20010131" 
 is the IdentifierPrefix and 00004 is produced by a Digitcount of 5.</p>
            <p>However, it could be possible that you would like an identical numbering 
 for the specimens.&#160;&#160;Therefore, each Identifier has a SequencePrefix.&#160;&#160;For 
 the OrderInternalId this could be "Order" and for the SpecimenInternalId 
 this could be "Specimen".&#160;&#160;This allows an identical 
 numbering for both the orders and the specimens.</p>
            <p>These sequences are stored in the gp_Sequence table which can be accessed 
 via the main menu (Site -&gt; System management -&gt; Scheme -&gt; Sequences).&#160;&#160;For 
 the example above the sequence could be Order20010131-.&#160;&#160;Each 
 day, a new sequence will be created and each time this sequence is called, 
 the identifier will be increased with 1.</p>
        </blockquote>
        <h3><a name="IsHoliday" id="IsHoliday"></a>IsHoliday<a href="#Top"><img src="../arrow.jpg" alt="Top" title="Top" width="14" height="14" align="right" border="0" /></a></h3>
        <p style="margin-left: 40px;">This function allows to check if the specified 
 date is a holiday or not.</p>
        <table style="margin-left: 40px;border-collapse: separate;border-collapse: separate;" cellspacing="0" width="90%" border="1">
            <tr>
                <td style="width: 100%;"><span style="font-style: italic;">Logical</span> <span style="font-weight: bold;">IsHoliday</span><span style="font-style: italic;">(Date</span> <span style="color: #008000;">Date</span><span style="font-style: italic;">)</span></td>
            </tr>
        </table>
        <h3><a name="NextValue" id="NextValue"></a>NextValue<b><a href="#Top"><img src="../arrow.jpg" alt="Top" title="Top" width="14" height="14" align="right" border="0" /></a></b></h3>
        <blockquote>
            <p>This function return the next integer value of the Sequencer Sequence, 
 incremented by 1.</p>
            <table style="border-collapse: separate;border-collapse: separate;" cellspacing="0" width="90%" border="1">
                <tr>
                    <td style="width: 100%;"><i style="font-style: italic;">Integer</i> <b>NextValue</b> (<i>String</i><span style="color: #008000;">Sequence</span>)</td>
                </tr>
            </table>
        </blockquote>
        <h3><a name="NumberToStringInFull" id="NumberToStringInFull"></a>NumberToStringInFull<b><a href="#Top"><img src="../arrow.jpg" alt="Top" title="Top" width="14" height="14" align="right" border="0" /></a></b></h3>
        <blockquote>
            <p>This function writes the specified number in full.&#160;&#160;However, 
 it only works in Dutch.</p>
            <table style="border-collapse: separate;border-collapse: separate;" cellspacing="0" width="90%" border="1">
                <tr>
                    <td style="width: 100%;"><i style="font-style: italic;">String</i> 
		 NumberToStringInFull (<i>Integer</i><span style="color: #008000;">Number</span> <i>String</i><span style="color: #008000;">Language</span>)&#160;</td>
                </tr>
            </table>
            <p>Example:&#160;</p>
            <table style="border-collapse: separate;border-collapse: separate;" cellspacing="0" width="90%" border="1">
                <tr>
                    <td style="width: 50%;">NumberToStringInFull (123456, "E") 
		 returns</td>
                    <td style="width: 50%;">honderddrieentwintigduizend vierhonderd 
		 zesenvijftig</td>
                </tr>
            </table>
        </blockquote>
        <h3 style="text-align: left;"><b><a name="SendMail" id="SendMail"></a>SendMail<a href="#Top"><img src="../arrow.jpg" alt="Top" title="Top" width="14" height="14" align="right" border="0" /></a></b>
        </h3>
        <p style="margin-left: 40px;text-align: left;"><b>T</b>his 
 function sends an internal or external mail.</p>
        <table style="margin-left: 40px;border-collapse: separate;border-collapse: separate;" cellspacing="0" width="90%" border="1">
            <tr>
                <td style="width: 100%;text-align: left;"><span style="font-style: italic;">Logical</span> <span style="font-weight: bold;">SendMail</span><span style="font-style: italic;">(String</span> <span style="color: #008000;">From</span><span style="font-style: italic;">, 
		 String</span><span style="color: #008000;">To</span><span style="font-style: italic;">, 
		 String</span><span style="color: #008000;">Subject</span><span style="font-style: italic;">, String</span><span style="color: #008000;">Content</span><span style="font-style: italic;">, MailPriority</span><span style="color: #008000;">Priority</span><span style="font-style: italic;">)</span></td>
            </tr>
        </table>
        <p style="margin-left: 40px;text-align: left;"><span style="font-style: italic;">String</span> <span style="color: #008000;">From</span></p>
        <p style="margin-left: 80px;text-align: left;">External mail: The e-mail address of the 
 sender. <span style="margin-left: 80px;"><br />There are also a number of predefined symbols provided:</span></p>
        <p style="margin-left: 80px;text-align: left;">- 'USER' : if you specify 'USER' as 'From' 
 argument, the e-mail address of the user currently logged in will be taken 
 as sender<span style="margin-left: 80px;"><br />- 'RESPONSIBLE' : the e-mail address of the responsible HCProvider for 
 the employee/user currently logged in<br />- 'SITE' : the e-mail address of the site, this address can be viewed/changed 
 in Site-&gt;System management-&gt;Customize-&gt;Mate</span></p>
        <p style="margin-left: 80px;text-align: left;">Internal mail: the login name of the sender</p>
        <p style="margin-left: 80px;text-align: left;">Note that the 'From' and the 'To' field must 
 be of the same type, either two login names or two e-mail addresses.</p>
        <p style="margin-left: 40px;text-align: left;"><span style="font-style: italic;">String</span> <span style="color: #008000;">To</span></p>
        <p style="margin-left: 80px;text-align: left;">The e-mail address or the login name of the 
 receiver.</p>
        <p style="margin-left: 40px;text-align: left;"><span style="font-style: italic;">String</span> <span style="color: #008000;">Subject</span><span style="font-style: italic;"><br />String</span><span style="color: #008000;">Content</span> &#160;</p>
        <p style="margin-left: 80px;text-align: left;">The content of the e-mail. <span style="margin-left: 80px;"><br />If you want to send e-mail in HTML format, the contents should start with 
 &lt;HTML&gt; and end with &lt;/HTML&gt;.<br />It is also possible to use a text module as content: {&lt;text module}.</span></p>
        <p style="margin-left: 40px;text-align: left;"><span style="font-style: italic;">MailPriority</span> <span style="color: #008000;">Priority</span></p>
        <p style="margin-left: 80px;text-align: left;">One of: <span style="color: #008000;">Low, 
 Normal, High</span></p>
        <h3><b><a name="SetSiteAttribute" id="SetSiteAttribute"></a>SetSiteAttribute<a href="#Top"><img src="../arrow.jpg" alt="Top" title="Top" width="14" height="14" align="right" border="0" /></a></b>
        </h3>
        <blockquote>
            <table style="border-collapse: separate;border-collapse: separate;" cellspacing="0" width="90%" border="1">
                <tr>
                    <td style="width: 100%;"><i style="font-style: italic;">Logical</i> <b>SetSiteAttribute</b> (<i>String</i><span style="color: #008000;">Table</span>, 
		 <i>Integer</i><span style="color: #008000;">RecordId</span>, <i>String</i> <span style="color: #008000;">AttributeName</span>, <i>String</i><span style="color: #008000;">Value</span>)</td>
                </tr>
            </table>
        </blockquote>
        <h3><a name="Translate" id="Translate"></a>Translate<b><a href="#Top"><img src="../arrow.jpg" alt="Top" title="Top" width="14" height="14" align="right" border="0" /></a></b></h3>
        <blockquote>
            <p>This function translates the dynamic-text-enabled Text into the language 
 named Language.</p>
            <table style="border-collapse: separate;border-collapse: separate;" cellspacing="0" width="90%" border="1">
                <tr>
                    <td style="width: 100%;"><i style="font-style: italic;">String</i> <b>Translate</b> (<i>Text</i><span style="color: #008000;">Text</span>, 
		 <i>String</i><span style="color: #008000;">Language</span>)</td>
                </tr>
            </table>
        </blockquote>
        <blockquote>
            <p>&#160;</p>
        </blockquote>
    </body>
</html>