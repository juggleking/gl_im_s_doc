<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-gb" xml:lang="en-gb" data-mc-search-type="Stem" data-mc-help-system-file-name="index.xml" data-mc-path-to-help-system="../../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Application management|Import &amp; Export" data-mc-priority="0" data-mc-time-estimate="0" data-mc-id="v55\english\system manual\tools\import-export\import_export12.htm">
    <!-- saved from url=(0016)http://localhost -->
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <meta name="ProgId" content="FrontPage.Editor.Document" /><title>Blood group data export &amp; import</title>
        <link href="../../../Resources/StyleSheets/shared.css" rel="stylesheet" type="text/css" />
        <script src="../../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/require.min.js" defer="defer" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/require.config.js" defer="defer" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/foundation.min.js" defer="defer" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/plugins.min.js" defer="defer" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAll.js" defer="defer" type="text/javascript">
        </script>
    </head>
    <body>
        <h1><a name="aanchor4163"></a>
            <MadCap:concept term="Application management" />Blood group data export &amp; import</h1>
        <p>Contents: <a href="#Blood_group_data_export">Blood group data export</a> -&#160;&#160;<a href="#Blood_group_data_import">Blood group data import</a></p>
        <h2><a name="Blood_group_data_export" id="Blood_group_data_export"></a>Blood group data export</h2>
        <p>Click Start -&gt; System management -&gt; Database -&gt; Specific export -&gt; Blood group data</p>
        <p>This program allows exporting all blood group data from the entire database into a file with a format suitable for import into another GLIMS database with the <a href="#Blood_group_data_import" name="kanchor387">blood group import program</a>.&#160;</p>
        <p>For each person in the database, for which a person medical record exists, the following data is exported:</p>
        <p>1. PIN code of the patient (by default PIN provider of current user)<br />2. blood group (untranslated)<br />3. rhesus D<br />4. (empty)<br />5. (empty)<br />6. (empty)<br />7. (empty)<br />8. (empty)<br />9. (empty)<br />10. first determination dates<br />11. second determination date<br />12. Positive screening<br />13. Positive screening date<br />14. list of mnemonics of (positive or negative) antigens;<br />if negative, the mnemonic is preceded by a '-'<br />15. list of mnemonics of (positive or negative) antibodies;<br />if negative, the mnemonic is preceded by a '-'<br />16. "Y" (blood group definite)<br />17. Last Screening Positive'<br />18. Last Screening date<br /><br />- The next lines contain the transfusion advice text, followed by a a line with only "---".<br />- The next lines contain the transfusion reactions text, followed by a line with only "---".</p>
        <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a style="font-weight: bold; color: #616E14;" href="javascript:void(0)" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage" aria-expanded="false"><img class="MCDropDown_Image_Icon" src="../../../../Skins/Default/Stylesheets/Images/transparent.gif" height="13" width="16" alt="Closed" data-mc-alt2="Open" />Notes</a></span>
            <div class="MCDropDownBody dropDownBody">
                <div class="text_box_notes">
                    <p><span style="color: #616E14; font-weight: bold;">Note</span>
                    </p>
                    <ul>
                        <li value="1">
                            <p>If the patient has no PIN, an error is given and the patient is skipped.</p>
                        </li>
                        <li value="2">
                            <p>All columns are separated by '|'</p>
                        </li>
                        <li value="3">
                            <p>All dates are in format DD/MM/YYYY</p>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <p>The program asks for the file path at start-up (Windows only). At the end the number of patients exported and failed is shown. Patients for which the export failed are written to a reject file, which is the same as the export file path, plus extension ".rej".</p>
        <h2><a name="Blood_group_data_import" id="Blood_group_data_import"></a>Blood group data import</h2>
        <h3><a name="Introduction" id="Introduction"></a>Introduction</h3>
        <p>Click Start -&gt; System management -&gt; Database -&gt; Specific import -&gt; Blood group data</p>
        <p>
            <img src="../import/import_blood_group_data.png" style="border: none;" alt="" width="467" height="131" border="0" />
        </p>
        <ul type="disc">
            <li class="p" value="1">
                <p><span style="font-weight: bold;">Import file</span>: select the file to be imported</p>
            </li>
            <li class="p" value="2">
                <p><span style="font-weight: bold;">Blood group rhesus</span>: <span style="text-align: center;">d</span>epending on your configuration (separate property for blood group and rhesus or not), you can specify one or two properties separated by a blank.</p>
            </li>
            <li class="p" value="3">
                <p><span style="font-weight: bold;">Coding system</span>: coding system to be used for antigen mnemonics</p>
            </li>
        </ul>
        <h3><a name="Contents of the import file"></a>Contents of the import file&#160;</h3>
        <ul>
            <li class="kadov-p" value="1">The import file must always end with a new line.</li>
            <li class="kadov-p" value="2">columns separated by '|'</li>
            <li class="kadov-p" value="3">all dates: format DD/MM/YYYY</li>
            <li class="kadov-p" value="4">columns: (mandatory unless specified; if optional, leave field blank)</li>
        </ul>
        <blockquote>
            <ol>
                <li class="kadov-p" value="1"><b style="font-weight: bold;">PIN code of patient</b>: if not found, then log error</li>
                <li class="kadov-p" value="2"><b style="font-weight: bold;">blood group</b>: 0 or O must both be accepted</li>
                <li class="kadov-p" value="3"><b style="font-weight: bold;">rhesus D</b>: pos or neg</li>
                <li class="kadov-p" value="4"><b style="font-weight: bold;">rhesus c</b> : pos/neg/+/-</li>
                <li class="kadov-p" value="5"><small style="font-size: smaller;"><b style="font-weight: bold;">rhesus C</b></small> : pos/neg/+/-</li>
                <li class="kadov-p" value="6"><small style="font-size: smaller;"><b style="font-weight: bold;">rhesus e</b></small> : pos/neg/+/-</li>
                <li class="kadov-p" value="7"><b style="font-weight: bold;">rhesus E</b> : pos/neg/+/-</li>
                <li class="kadov-p" value="8"><small style="font-size: smaller;"><b style="font-weight: bold;">Kell</b>:</small> pos/neg/+/-</li>
                <li class="kadov-p" value="9"><small style="font-size: smaller;"><b style="font-weight: bold;">CMV status</b>:</small> pos/neg/+/-</li>
                <li class="kadov-p" value="10"><b style="font-weight: bold;">date det.1</b> (optional)</li>
                <li class="kadov-p" value="11"><b style="font-weight: bold;">date det.2</b> (optional)</li>
                <li class="kadov-p" value="12"><b style="font-weight: bold;">irreg. antibody screening result</b>: POS*, NEG* or "" (optional)</li>
                <li class="kadov-p" value="13"><b style="font-weight: bold;">date screening</b>: only if screening positive (optional)</li>
                <li class="kadov-p" value="14"><b style="font-weight: bold;">antigen presence/absence list</b>: comma-separated list of mnemonics of the antigens if present, or the mnemonic preceded by a '-' sign if absent</li>
                <li class="kadov-p" value="15"><b style="font-weight: bold;">antibody presence/absence list</b>: comma-separated list of mnemonics of the antigens if the antibody is present, or the mnemonic preceded by a '-' sign if the antibody is absent</li>
                <li class="kadov-p" value="16"><b style="font-weight: bold;">blood group definite</b>: <small>Y/N</small><blockquote><p>When the blood group is not definite, it will NOT be stored in the person medical record. Only the date of first determination will be saved into the person medical record. The data will be put out in a format which is ready for the GLIMS result import program to be read, so that the first determination can be stored as a result record. It will be written to the file "BTM_RSLT.TXT".<br />For this purpose the program will ask -before starting- the mnemonic of the property that contains the Blood group + Rhesus information.</p></blockquote></li>
                <li class="kadov-p" value="17">The '<b>latest screening positive</b>': this must be 'POS' or 'NEG' or empty</li>
                <li class="kadov-p" value="18">The '<b>latest screening date/time</b>': this is the date of the latest screening in format 'DD/MM/YYYY' or 'DD/MM/YYYY HH:MM'</li>
                <li class="kadov-p" value="19">The next lines contain <b>optional transfusion advice text</b>, until a line containing only "---" is encountered.</li>
                <li class="kadov-p" value="20">The <b>transfusion reactions</b> can also be imported, in the same way as and underneath the transfusion advices</li>
            </ol>
        </blockquote>
        <p>Remarks:&#160;</p>
        <ul>
            <li class="kadov-p" value="1">The fields 'Blood group' and 'Rhesus' are optional fields. This means that -when these fields are both empty- the person's blood group and rhesus will be left unchanged (like they existed in GLIMS). Please note that they cannot be imported separately. Both (or neither) of them should be available.</li>
            <li class="kadov-p" value="2">The lists of antigens and antibodies can have syntax Kell- or -Kell.&#160;&#160;You can also use Kell+ instead of Kell.</li>
            <li class="kadov-p" value="3">To implement field 3...8, the program makes use of the antigen meanings as defined in the 'meaning' field of the antigens</li>
        </ul>
        <h3><a name="Example of an import file"></a>Example of an import file</h3><pre>
======================================================================= 
121212 | O | neg |-|+|-|+|-|+| 01/04/2001 | | POS | 02/05/1998 11:12:13 | Fy-A, -K | | Y | pos | 02/04/2002
Here are the advices:
&lt;line1&gt;
&lt;line2&gt;
...
---
Here are the reactions:
&lt;line1&gt;
&lt;line2&gt;
...
---
(next patient...)
=======================================================================
</pre>
    </body>
</html>