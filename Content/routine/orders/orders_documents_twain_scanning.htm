<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-gb" xml:lang="en-gb" data-mc-search-type="Stem" data-mc-help-system-file-name="index.xml" data-mc-path-to-help-system="../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Routine|Orders|Order documents" data-mc-priority="0" data-mc-time-estimate="0" data-mc-id="Generate_document">
    <!-- saved from url=(0016)http://localhost -->
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>Order documents - Twain scanning</title>
        <link href="../../Resources/StyleSheets/shared.css" rel="stylesheet" type="text/css" />
        <script src="../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../Resources/Scripts/require.min.js" defer="defer" type="text/javascript">
        </script>
        <script src="../../../Resources/Scripts/require.config.js" defer="defer" type="text/javascript">
        </script>
        <script src="../../../Resources/Scripts/foundation.min.js" defer="defer" type="text/javascript">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js" defer="defer" type="text/javascript">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js" defer="defer" type="text/javascript">
        </script>
    </head>
    <body>
        <h1>Order/Patient documents - Twain scanning</h1>
        <div class="text_box_warnings">
            <p><span style="color: #ff0000; font-weight: bold;">Warning</span>
            </p>
            <p>The Twain scanning solution is deprecated and will no longer be implemented. MIPS will continue to provide support for existing installations though.</p>
        </div>
        <h2>Description</h2>
        <p>GLIMS offers a solution that incorporates <span style="font-weight: bold;">Twain 
 image scanning</span> abilities directly into GLIMS. </p>
        <p>Configurable order and patient documents 
 can be scanned and attached to the specific context record while creating 
 or updating an order. &#160;</p>
        <div class="text_box_notes">
            <p><span style="color: #616E14; font-weight: bold;">Note</span>
            </p>
            <p>GLIMS also allows to <a href="orders_documents_create_CD.htm">prepare 
 a CD</a> that contains a copy of all originally scanned order forms.</p>
        </div>
        <p>The Twain scan functionality is implemented as an interaction between 
 order entry and a <span style="font-weight: bold;">java translator named 
 "j_twain"</span> that communicates with the Twain scanner driver 
 installed on the machine where the scanner is attached via USB. &#160;</p>
        <div class="text_box_notes">
            <p><span style="color: #616E14; font-weight: bold;">Note</span>
            </p>
            <p>This feature requires version 2.0.0 
 or higher of the "j_twain" driver.</p>
        </div>
        <p>In the <span class="ui_element">general options</span>, the 
 tab page called <span class="ui_element">Scan</span> 
 offers some <span class="ui_element">Twain scan</span> options.</p>
        <p><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="twain_scan_options.png" data-mc-popup-alt=""><img class="MCPopupThumbnail img imgLargeImage" data-mc-width="787" data-mc-height="523" src="twain_scan_options_thumb_0_120.png" alt="" tabindex="" /></a>
        </p>
        <p>After having selected the Twain scanner translator, a <span class="ui_element">Twain 
 Scan</span> button appears on the left side of the Options button 
 in the order entry window.</p>
        <p style="text-align: left;"><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="scan_twain_oe_scan_button.png" data-mc-popup-alt=""><img class="MCPopupThumbnail img imgLargeImage" data-mc-width="693" data-mc-height="449" src="scan_twain_oe_scan_button_thumb_0_120.png" alt="" tabindex="" /></a>
        </p>
        <p class="MsoListParagraphCxSpFirst" style="margin-left: 0in;text-align: justify;">When pressing this button during order entry, 
 a screen opens that allows selecting the type of document to be scanned 
 (see below: Configuration).</p>
        <p class="MsoListParagraphCxSpFirst" style="margin-left: 0in;text-align: left;"><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="scan_twain_oe_document_types.png" data-mc-popup-alt=""><img class="MCPopupThumbnail img imgLargeImage" data-mc-width="213" data-mc-height="133" src="scan_twain_oe_document_types_thumb_0_120.png" alt="" tabindex="" /></a>
        </p>
        <p class="MsoListParagraphCxSpFirst" style="margin-left: 0in;text-align: justify;">When all documents for a particular order are 
 scanned, the order is saved and a process message is sent to the Twain 
 translator. At this point in time, the processing of the scanned images 
 is detached from order entry.</p>
        <p class="MsoListParagraphCxSpFirst" style="margin-left: 0in;text-align: justify;">Scanned documents on a person record or an order 
 during order entry can be reviewed by opening the <a href="../../configuration/attachments/attachments.htm">attachment 
 browser</a>. The scanned images are saved in tiff format so they will 
 be shown in the windows specific tiff viewer (e.g. windows photo gallery).</p>
        <h2>Configuration</h2>
        <p class="fieldlabel">Document types</p>
        <div class="indented">
            <p>The document types to be scanned need to be 
 configured in the field <span class="ui_element">Twain scan 
 categories</span> in the <span class="ui_element">general options</span> (System management -&gt; 
 Customize -&gt; GLIMS general). </p>
            <p>For each document type, a button will be displayed 
 in the scan screen (see example above: Order form, Patient insurance). 
 &#160;Each document type is configured as a text line with the following 
 parameters (comma-separated):</p>
            <p><span class="ui_element">&lt;context&gt;,&lt;attachment category&gt;,&lt;file 
 name&gt;,&lt;button text&gt;,&lt;store in order.image&gt;,&lt;color/bw&gt;,&lt;simplex/duplex&gt;,&lt;attachment 
 description&gt;</span>
            </p>
            <p class="fieldlabel">&lt;context&gt;</p>
            <div class="indented">
                <p>
	 The context of the document type determines the base table of the 
	 attachment. &#160;Currently supported values:</p>
                <p class="fieldlabel">Order</p>
                <div class="indented">
                    <p> 
		 The scanned document will be attached to the Order record</p>
                </div>
                <p class="fieldlabel">Person
	</p>
                <div class="indented">
                    <p>The scanned document will be attached to the Person record (patient)</p>
                </div>
            </div>
            <p class="fieldlabel">&lt;attachment 
	 category&gt;</p>
            <div class="indented">
                <p class="mips_list_bulleted">The <a href="../../configuration/attachments/attachments.htm">attachment 
	 category</a> for the scanned document. Must correspond with the "Name" of an existing attachment category.</p>
            </div>
            <p class="fieldlabel">&lt;file 
	 name&gt;</p>
            <div class="indented">
                <p class="mips_list_bulleted"> The file name of the scanned document, without file extension. 
	 &#160;The scanned documents are always saved in tiff format. &#160;This 
	 parameter also supports a reference to a SpecificSite-based text module 
	 (e.g. <span style="font-style: italic;">{&lt;FileName}</span>)</p>
            </div>
            <p class="fieldlabel">&lt;button 
	 text&gt;</p>
            <div class="indented">
                <p class="mips_list_bulleted">The text that will appear as button label in the scan 
	 screen. This parameter also supports a reference to a SpecificSite-based 
	 text module (e.g. <span style="font-style: italic;">{&lt;OrderFormButtonText}</span>)</p>
            </div>
            <p class="fieldlabel">&lt;store 
	 in order.image&gt;</p>
            <div class="indented">
                <p class="mips_list_bulleted"> The possible values: "yes" or "no". 
	 &#160;If set to "yes", scanned document types with context 
	 "Order" can be saved in the Order.Image field. &#160;This 
	 document can be viewed with the Order.ViewImage function which is 
	 available from the Order contextual menu via Documents -&gt; View order 
	 document. &#160;If this parameter is set to "yes" for multiple 
	 document types, only the last scanned document will be saved in the 
	 Order.Image field. &#160;For document types with context "person", 
	 set this parameter to "no".</p>
                <p class="mips_list_bulleted">To store an image in the Order.Image field, you need to define the <a href="../results/results_images.htm">ImageServerDir</a> environment variable. The images will be copied to the directory specified for this environment variable.</p>
                <p class="fieldlabel">&lt;color/bw&gt;</p>
                <div class="indented">
                    <p class="mips_list_bulleted"> 
	 Should the document be scanned in color or black/white.</p>
                </div>
                <p class="fieldlabel">&lt;simplex/duplex&gt;</p>
                <div class="indented">
                    <p class="mips_list_bulleted"> 
	 Should the document be scanned single-sided or double-sided.</p>
                </div>
                <p class="fieldlabel">&lt;attachment 
	 description&gt;</p>
                <div class="indented">
                    <p class="mips_list_bulleted"> Optional description for the attachment. This 
	 parameter also supports a reference to a SpecificSite-based text module 
	 (e.g. <span style="font-style: italic;">{&lt;AttachmentDescription}</span>). 
	 &#160;If not specified, the file name is used as description.</p>
                </div>
            </div>
            <div class="text_box_warnings">
                <p><span style="color: #ff0000; font-weight: bold;">Warning</span>
                </p>
                <p>All 
 parameters except the attachment description are mandatory !!</p>
            </div>
            <div class="text_box_examples" xmlns="http://www.w3.org/1999/xhtml">
                <p xmlns="http://www.w3.org/1999/xhtml"><span style="color: #003366; font-weight: bold;">Example</span>
                </p>
                <p xmlns="http://www.w3.org/1999/xhtml">order,Ordonnance,ORDO-{=.InternalId}-{=.CreationUser.LoginName},{&lt;OrdoButtonText},no,bw,duplex,{&lt;OrdoFixedDescription}<br />order,Renouvellement,RENOU-{=.InternalId}-{=.LastUpdateUser.LoginName},{&lt;RenouButtonText},yes,color,simplex<br />person,PersonDocument,PERSON-{.FirstName}-{=.LastName},{&lt;PoidsText},no,color,simplex</p>
            </div>
        </div>
        <p style="font-weight: bold;background-color: Transparent;">Location of 
 scanned documents</p>
        <div class="indented">
            <p>There are two ways to define the location of 
 the scanned documents:</p>
            <ol>
                <li value="1">In 
	 progress.ini define a variable GLIMSAttachmentRootFolder. This folder 
	 will contain subdirectories per context (order or person in this case) 
	 and per rec id of the record to which the scanned document will be 
	 attached (e.g. "\\Server\Attachments\" ). This path will 
	 be used both on Windows and Unix.</li>
                <li value="2">On 
	 the Order or Person table, a site function named "AttachmentFolder" 
	 can be defined. If this function is defined, it has priority over 
	 the progress.ini variable. This site function allows to define a more 
	 specific path. &#160;</li>
            </ol>
            <div class="text_box_examples" xmlns="http://www.w3.org/1999/xhtml">
                <p xmlns="http://www.w3.org/1999/xhtml"><span style="color: #003366; font-weight: bold;">Example</span>
                </p>
                <p xmlns="http://www.w3.org/1999/xhtml"><span style="font-style: italic;">STRING sPath;<br />	STRING sRootFolder;<br />	sRootFolder := "\\ServerName\attachments\";<br />	sPath := sRootFolder;<br />	sPath := sPath + "ORDER\";<br />	sPath := sPath + DateTimeToString(.CreationTime, "%Y\%m\%d\");<br />	sPath := sPath + .InternalID + "\";<br />	RETURN sPath;</span>
                </p>
            </div>
            <div class="text_box_notes" xmlns="http://www.w3.org/1999/xhtml">
                <p><span style="color: #616E14; font-weight: bold;">Note</span>
                </p>
                <ul>
                    <li class="mips_list_bulleted" value="1">The location of the attachments 
		 has to be set correctly from the first scan on. If the location 
		 is modified, then attached documents will not be found, unless 
		 the folders are manually copied to the newly defined location.</li>
                </ul>
                <ul>
                    <li class="mips_list_bulleted" value="1">The location has to be specified 
		 as a UNC path e.g. <span>\\Server\share\attachmentFolder</span>.</li>
                </ul>
                <ul>
                    <li class="mips_list_bulleted" value="1">
                        <p class="MsoNormal" style="margin-left: 0px;">For 
		 attachment servers running on Unix, this path will be truncated 
		 to e.g. \share\attachmentFolder . If the attachment repository 
		 is e.g. on a SAN then the symbolic link needs to be created manually. 
		 &#160;Example: windows path is \\hyperion\attachments\repo and 
		 the physical path where the images on the Unix hyperion machine 
		 reside is \usr\images. Then a symbolic link needs to be created 
		 on Unix between \attachments\repo and \usr\images.</p>
                    </li>
                </ul>
            </div>
        </div>
        <p style="font-weight: bold;">Translator</p>
        <div class="indented">
            <p>A translator must be defined (driver is "<span style="font-weight: bold;">j_twain</span>") with the correct 
 port number to connect to the Twain service. One translator per physically 
 installed Twain scanner is required. </p>
        </div>
        <p style="font-weight: bold;">General options (Scan tab page)</p>
        <div class="indented">
            <p class="fieldlabel">Twain translator</p>
            <div class="indented">
                <p> 
 Select the translator that will be used to communicate with the Twain 
 driver.</p>
            </div>
        </div>
        <p style="margin-left: 0px;font-weight: bold;">Driver options</p>
        <p style="margin-left: 40px;font-weight: normal;">The driver "j_twain" 
 offers some additional options. &#160;Please check the driver documentation 
 for more information.</p>
        <h2>Remarks</h2>
        <ul>
            <li class="p" value="1">
                <p><span style="font-weight: bold;">Relative image path</span> 
	 is stored in Order.Image field.</p>
            </li>
            <li class="p" value="2">
                <p><span style="font-weight: bold;">Re-scan is possible</span> 
	 and overwrites any existing image. &#160;A warning will be shown.</p>
            </li>
            <li class="p" value="3">
                <p><span style="font-weight: bold;">Images can be viewed</span> 
	 via the attachment browser or via the Order contextual menu "Documents 
	 -&gt; View order documents" (if stored in the Order.Image field).</p>
            </li>
        </ul>
    </body>
</html>