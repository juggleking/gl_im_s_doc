<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-gb" xml:lang="en-gb" data-mc-search-type="Stem" data-mc-help-system-file-name="index.xml" data-mc-path-to-help-system="../../../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Communication|Direct communication|Patient data">
    <!-- saved from url=(0016)http://localhost -->
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>CPage - Direct communication mode</title>
        <link href="../../../../Resources/StyleSheets/shared.css" rel="stylesheet" type="text/css" />
        <script src="../../../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../../../Resources/Scripts/require.min.js" defer="defer" type="text/javascript">
        </script>
        <script src="../../../../../Resources/Scripts/require.config.js" defer="defer" type="text/javascript">
        </script>
        <script src="../../../../../Resources/Scripts/foundation.min.js" defer="defer" type="text/javascript">
        </script>
        <script src="../../../../../Resources/Scripts/plugins.min.js" defer="defer" type="text/javascript">
        </script>
        <script src="../../../../../Resources/Scripts/MadCapAll.js" defer="defer" type="text/javascript">
        </script>
    </head>
    <body>
        <h1>CPage - Direct communication mode</h1>
        <p>Contents: <a href="#Introduction">Introduction</a> - <a href="#CPage_processing_option">CPage processing options</a> - <a href="#Installation">Installation</a> - <a href="#Data_mapping">Data mapping</a></p>
        <h2><a name="Introduction" id="Introduction"></a>Introduction</h2>
        <p>Glims offers a direct communication mode between the Glims and CPage HIS database for the update of patient data (instead of using a translator that processes files produced by the CPage system).</p>
        <h2><a name="CPage_processing_option" id="CPage_processing_option"></a>CPage processing options</h2>
        <p>The CPage processing function can be accessed by selecting Start &gt; System management &gt; Process CPage data. The following options are available:</p>
        <p><b style="font-weight: bold;">Identification source</b>
        </p>
        <blockquote>
            <p>If specified, the identification source will be used to set</p>
            <ul>
                <li value="1">the identification source for patients</li>
                <li value="2">the institution for encounters</li>
            </ul>
            <p>If not specified, the program will still use the identification source as stored in the order entry preferences from the executing user.</p>
        </blockquote>
        <p><b style="font-weight: bold;">Destination table name</b>
        </p>
        <blockquote>
            <p>The name of the Cpage table containing a link to the messages for a specified destination (default: MMS).&#160;&#160;If a view on MMS is defined, this view can be specified instead of the table.</p>
        </blockquote>
        <p><b style="font-weight: bold;">Message table name</b>
        </p>
        <blockquote>
            <p>The name of the Cpage table containing the messages (default: MBO). If a view on MBO is defined, this view can be specified instead of the table. This can be useful if the medical archive number is used instead of the IPP number.</p>
        </blockquote>
        <p><b style="font-weight: bold;">Destination code</b>
        </p>
        <blockquote>
            <p>The destination code as it is defined in the DESMMS field of the destination table. (default: "GLIMS")</p>
        </blockquote>
        <p><b style="font-weight: bold;">Initial status</b>
        </p>
        <blockquote>
            <p>The status of the messages, as defined in the ETAMMS field of the destination table, &#160;that have to be marked for processing. (default: "P")</p>
        </blockquote>
        <p><b style="font-weight: bold;">Transaction status</b>
        </p>
        <blockquote>
            <p>The status of the messages, as defined in the ETAMMS field of the destination table,&#160;&#160;that will be selected for processing. (default: "C")</p>
        </blockquote>
        <p><b style="font-weight: bold;">Final status</b>
        </p>
        <blockquote>
            <p>The status of the messages, as defined in the ETAMMS field of the destination table,&#160;&#160;that have been successfully processed. (default: "E")</p>
        </blockquote>
        <p><b style="font-weight: bold;">Failure status</b>
        </p>
        <blockquote>
            <p>The status of the messages, as defined in the ETAMMS field of the destination table,&#160;&#160;that have been unsuccessfully processed. (default: "R")</p>
        </blockquote>
        <p><b style="font-weight: bold;">Delete processed records</b>
        </p>
        <blockquote>
            <p>If set, the successfully processed records will be deleted from the destination table.</p>
        </blockquote>
        <p><b style="font-weight: bold;">Always set spouse name</b>
        </p>
        <blockquote>
            <p>If this option is NOT set, the CPGD interface will only set the spouse last name (in Glims) if it is specified and different from the name. In other cases (equal, but both specified) it will be cleared.</p>
        </blockquote>
        <h4>Ignore M2 messages with extension code 2</h4>
        <p class="style1">If set, the interface will ignore M2 records with 7th character of DISMBO = "2".</p>
        <h2><a name="Installation" id="Installation"></a>Installation</h2>
        <h3>Oracle software</h3>
        <p>We assume that the Cpage interface will be used on the Glims server only. (via a cron command).&#160;&#160;On this Glims server machine, the Oracle product must be available. If it is the same machine as the machine where the Cpage database is installed, Oracle is already available and nothing must be installed anymore. If it is another machine,&#160;&#160;it might be necessary to install Oracle.</p>
        <h3>Schema holder</h3>
        <p>On the Glims server a local schema holder database cpage_sh.* should be available.&#160;&#160;This schema holder should be delivered by MIPS. It is created using Progress tools by extracting the schema from the cpage Oracle database.</p>
        <p>Note: if a view containing stored procedures is being used, then it might be necessary to update the schema holder on site. In this case you only need to load the dump file cpage_view.df, delivered by MIPS.</p>
        <h3>pinstall script option</h3>
        <p xmlns="http://www.w3.org/1999/xhtml">An option is available in the pinstall script (for UNIX)&#160;to install a Cpage schema holder for connecting a Cpage Oracle database. The connection files are also supplied.</p>
        <p class="fieldlabel" xmlns="http://www.w3.org/1999/xhtml">Usage</p>
        <ul xmlns="http://www.w3.org/1999/xhtml">
            <li value="1">pinstall -c &lt;configuration file&gt; + option from menu.</li>
            <li value="2">pinstall -c &lt;configuration file&gt; - s 9 (new installation)</li>
            <li value="3">pinstall -c &lt;configuration file&gt; - s 18 (upgrade installation)</li>
        </ul>
        <p xmlns="http://www.w3.org/1999/xhtml">When this option is selected, pinstall will:</p>
        <ul xmlns="http://www.w3.org/1999/xhtml">
            <li xmlns="http://www.w3.org/1999/xhtml" value="1">create a Cpage schema holder cpage_sh.* on the target dbf directory</li>
            <li xmlns="http://www.w3.org/1999/xhtml" value="2">create cpage_sh.cpf and cpage.cpf on the target dat directory</li>
        </ul>
        <h3>Oracle configuration</h3>
        <p>1. A dedicated Oracle user "oracpage" should be created to query the Cpage tables MMS and MBO from Glims. (this Oracle user name must match the user defined in the schema holder; so choose this name).&#160;&#160;This user should preferably be created in a dedicated table space: (example for Oracle 9 or 10)</p>
        <blockquote>
            <p><span style="font-size: 10.0pt;font-family: 'Courier New';color: #0000ff;">CREATE TEMPORARY</span><span style="font-size: 10.0pt;font-family: 'Courier New';">TABLESPACE cpage_temp</span><span style="font-size: 10.0pt;font-family: 'Courier New';"><br />TEMPFILE '&lt;Oracle database directory&gt;\cpage_temp'<span style="color: #0000ff;"><br />SIZE</span> 20M REUSE<br />EXTENT MANAGEMENT <span style="color: #0000ff;">LOCAL</span><br />UNIFORM <span style="color: #0000ff;">SIZE</span> 256K;</span>
            </p>
            <p class="MsoNormal" style="text-autospace: none;"><span style="font-size: 10.0pt;font-family: 'Courier New';color: #0000ff;">CREATE</span><span style="font-size: 10.0pt;font-family: 'Courier New';">TABLESPACE cpage_usrsp DATAFILE '&lt;Oracle database</span><span style="font-size: 10.0pt;font-family: 'Courier New';">directory&gt;\cpage_usrsp' <span style="color: #0000ff;"><br />SIZE</span> 5M REUSE<br />EXTENT MANAGEMENT <span style="color: #0000ff;">LOCAL</span></span><span style="font-size: 10.0pt;font-family: 'Courier New';"><br />UNIFORM <span style="color: #0000ff;">SIZE</span> 256K;</span>
            </p>
        </blockquote>
        <p style="text-autospace: none;">This user must be granted privileges to access the MMS and MBO tables, which belong to another Oracle user; supposing they are from &lt;Oracle user&gt;, then the Oracle DBA should issue the following commands to grant them:</p>
        <p style="text-autospace: none;">connect &lt;Oracle user name&gt;/&lt;Oracle user password&gt;;</p>
        <p class="MsoNormal" style="margin-left: 18.0pt;">CREATE USER oracpage IDENTIFIED BY oracpage98</p>
        <p class="MsoNormal" style="margin-left: 18.0pt;">&#160;&#160;&#160;&#160;DEFAULT TABLESPACE cpage_usrsp</p>
        <p class="MsoNormal" style="margin-left: 18.0pt;">&#160;&#160;&#160;&#160;TEMPORARY TABLESPACE cpage_temp;</p>
        <p class="MsoNormal" style="margin-left: 18.0pt;">GRANT CREATE SESSION TO oracpage;</p>
        <p class="MsoNormal" style="margin-left: 18.0pt;">GRANT CREATE SYNONYM TO oracpage;</p>
        <p class="MsoNormal" style="margin-left: 18.0pt;">GRANT SELECT ON &lt;Oracle user&gt;.MMS to oracpage;</p>
        <p class="MsoNormal" style="margin-left: 18.0pt;">GRANT UPDATE ON &lt;Oracle user&gt;.MMS to oracpage;</p>
        <p class="MsoNormal" style="margin-left: 18.0pt;">GRANT SELECT ON &lt;Oracle user&gt;.MBO to oracpage;</p>
        <p class="MsoNormal" style="margin-left: 18.0pt;">GRANT UPDATE ON &lt;Oracle user&gt;.MBO to oracpage;</p>
        <p class="MsoNormal" style="margin-left: 18.0pt;">CONNECT oracpage/oracpage98</p>
        <p class="MsoNormal" style="margin-left: 18.0pt;">CREATE SYNONYM MMS2 FOR &lt;Oracle user&gt;.MMS;</p>
        <p class="MsoNormal" style="margin-left: 18.0pt;">CREATE SYNONYM MBO2 FOR &lt;Oracle user&gt;.MBO;</p>
        <p class="MsoNormal" style="margin-left: 18.0pt;">If Cpage has to be used with medical archive numbers (see 5), then access to the stored procedure/function <span style="font-size: 10.0pt;font-family: Arial;color: #0000ff;">NCPK_QRY_MSG.F_QRY should be granted to the oracpage user too:</span></p>
        <p class="MsoNormal" style="margin-left: 18.0pt;"><span style="font-size: 10.0pt;font-family: Arial;color: #0000ff;">&#160;</span>GRANT EXECUTE ON &lt;Oracle user&gt;.<span style="font-size: 10.0pt;font-family: Arial;color: #0000ff;">NCPK_QRY_MSG</span> to oracpage;</p>
        <p class="MsoNormal" style="margin-left: 18.0pt;">CREATE SYNONYM <span style="font-size: 10.0pt;font-family: Arial;color: #0000ff;">NCPK_QRY_MSG</span> FOR &lt;Oracle user&gt;.<span style="font-size: 10.0pt;font-family: Arial;color: #0000ff;">NCPK_QRY_MSG</span>;<br />&#160;</p>
        <p>2. A listener for the Cpage database should be active on the machine where the Cpage database is installed, e.g. the listener configuration file listener.ora should have an entry like</p>
        <p class="MsoNormal">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;(SID_DESC =</p>
        <p class="MsoNormal">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;(GLOBAL_DBNAME = &lt;cpage global database name&gt;)</p>
        <p class="MsoNormal">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;(ORACLE_HOME = &lt;Oracle installation directory&gt;)</p>
        <p class="MsoNormal">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;(SID_NAME = &lt;cpage database name&gt;)</p>
        <p class="MsoNormal">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;)</p>
        <p class="MsoNormal" style="text-indent: 18.0pt;">and the listener should be running.</p>
        <p>-On the machine where Glims is installed the tsnames.ora file (&lt;Oracle installation directory&gt;\network\admin) should have an entry for the Cpage database:</p>
        <p class="MsoNormal" style="text-indent: 18.0pt;text-autospace: none;"><span style="font-size: 10.0pt;font-family: 'Courier New';">cpage =</span>
        </p>
        <p class="MsoNormal" style="text-autospace: none;"><span style="font-size: 10.0pt;font-family: 'Courier New';">&#160;&#160;(DESCRIPTION =</span>
        </p>
        <p class="MsoNormal" style="text-autospace: none;"><span style="font-size: 10.0pt;font-family: 'Courier New';">&#160;&#160;&#160;&#160;(ADDRESS_LIST =</span>
        </p>
        <p class="MsoNormal" style="text-autospace: none;margin-left: 36.0pt;"><span style="font-size: 10.0pt;font-family: 'Courier New';">(ADDRESS = (PROTOCOL = TCP)(HOST = &lt;Cpage database host&gt;)(PORT = 1521))</span>
        </p>
        <p class="MsoNormal" style="text-autospace: none;"><span style="font-size: 10.0pt;font-family: 'Courier New';">&#160;&#160;&#160;&#160;&#160;&#160;)</span>
        </p>
        <p class="MsoNormal" style="text-autospace: none;"><span style="font-size: 10.0pt;font-family: 'Courier New';">&#160;&#160;&#160;&#160;(CONNECT_DATA =</span>
        </p>
        <p class="MsoNormal" style="text-autospace: none;"><span style="font-size: 10.0pt;font-family: 'Courier New';">&#160;&#160;&#160;&#160;&#160;&#160;(SID = &lt;cpage instance name&gt;)</span>
        </p>
        <p class="MsoNormal" style="text-autospace: none;"><span style="font-size: 10.0pt;font-family: 'Courier New';">&#160;&#160;&#160;&#160;&#160;&#160;)</span>
        </p>
        <p class="MsoNormal" style="text-autospace: none;"><span style="font-size: 10.0pt;font-family: 'Courier New';">&#160;&#160;&#160;)</span>
        </p>
        <h3>Glims configuration</h3>
        <h4>.glimsrc (Unix) or progress.ini (Windows)</h4>
        <blockquote>
            <p>Add entry GLIMSCPAGE_SH_DBF = &lt;cpage schema holder database path&gt;\cpage_sh</p>
        </blockquote>
        <h4>connection files</h4>
        <blockquote>
            <p>Add connection files cpage_sh.cpf and cpage.cpf in &lt;application root&gt;\dat folder.</p>
            <p>Cpage_sh.cpf contains connection string to the schema holder&#160;:</p>
        </blockquote>
        <p class="MsoNormal" style="text-autospace: none;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span style="font-size: 10.0pt;font-family: 'Courier New';">-RO -1</span></p>
        <blockquote>
            <p class="MsoNormal" style="text-autospace: none;">Cpage.cpf contains connection string to the Oracle database:</p>
            <blockquote>
                <p class="MsoNormal" style="text-autospace: none;"><span style="font-size: 10.0pt;font-family: 'Courier New';">-db cpage -dt ORACLE -Dsrv SKIP-SCHEMA-CHECK</span><span style="font-size: 10.0pt;font-family: 'Courier New';"><br />-U oracpage@cpage -P oracpage98 -c 500</span>
                </p>
            </blockquote>
        </blockquote>
        <h4 style="text-autospace: none;">session.pf</h4>
        <p style="margin-left: 36.0pt;">It might be necessary to increase the –h parameter (=number of databases) to at least 5</p>
        <h4>* SQL net configuration</h4>
        <p>A listener for the Cpage database should be active on the machine where the Cpage database is installed, e.g. the listener configuration file listener.ora should have an entry like&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</p>
        <p class="MsoNormal">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;(SID_DESC =</p>
        <p class="MsoNormal">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;(GLOBAL_DBNAME = &lt;cpage global database name&gt;)</p>
        <p class="MsoNormal">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;(ORACLE_HOME = &lt;Oracle installation directory&gt;)</p>
        <p class="MsoNormal">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;(SID_NAME = &lt;cpage database name&gt;)</p>
        <p class="MsoNormal">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;)</p>
        <p class="MsoNormal">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;and the listener should be running.</p>
        <p class="MsoNormal" style="margin-left: 36.0pt;">On the machine where Glims is installed (this may be server or client; in fact the machine where the cpage interface will be used, most likely the server),</p>
        <p class="MsoNormal" style="margin-left: 36.0pt;">The tsnames.ora file (&lt;should contain an entry</p>
        <h2><a name="Data_mapping" id="Data_mapping"></a>Data mapping</h2>
        <p><a href="cpage_direct_mapping/cpg_messages.htm">Click here for a full description of the data mapping between the Glims database and the CPage database.</a>
        </p>
    </body>
</html>